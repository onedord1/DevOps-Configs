{{- /*
Generated from 'k8s-resources-pod' from https://raw.githubusercontent.com/prometheus-operator/kube-prometheus/a8ba97a150c75be42010c75d10b720c55e182f1a/manifests/grafana-dashboardDefinitions.yaml
Do not change in-place! In order to change this file first read following link:
https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack/hack
*/ -}}
{{- $kubeTargetVersion := default .Capabilities.KubeVersion.GitVersion .Values.kubeTargetVersionOverride }}
{{- if and (or .Values.grafana.enabled .Values.grafana.forceDeployDashboards) (semverCompare ">=1.14.0-0" $kubeTargetVersion) (semverCompare "<9.9.9-9" $kubeTargetVersion) .Values.grafana.defaultDashboardsEnabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: {{ template "kube-prometheus-stack-grafana.namespace" . }}
  name: {{ printf "%s-%s" (include "kube-prometheus-stack.fullname" $) "aes-cluster-overview" | trunc 63 | trimSuffix "-" }}
  annotations:
{{ toYaml .Values.grafana.sidecar.dashboards.annotations | indent 4 }}
  labels:
    {{- if $.Values.grafana.sidecar.dashboards.label }}
    {{ $.Values.grafana.sidecar.dashboards.label }}: {{ ternary $.Values.grafana.sidecar.dashboards.labelValue "1" (not (empty $.Values.grafana.sidecar.dashboards.labelValue)) | quote }}
    {{- end }}
    app: {{ template "kube-prometheus-stack.name" $ }}-grafana
{{ include "kube-prometheus-stack.labels" $ | indent 4 }}
data:
  aes-cluster-overview.json: |-
    {{`{"annotations":{"list":[{"builtIn":1,"datasource":{"type":"grafana","uid":"-- Grafana --"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":35,"links":[],"liveNow":false,"panels":[{"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":20,"title":"Overview","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"mappings":[],"max":1,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"percentunit","unitScale":true},"overrides":[]},"gridPos":{"h":5,"w":8,"x":0,"y":1},"id":21,"options":{"displayMode":"lcd","maxVizHeight":300,"minVizHeight":16,"minVizWidth":8,"namePlacement":"auto","orientation":"horizontal","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showUnfilled":true,"sizing":"auto","valueMode":"color"},"pluginVersion":"10.3.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"avg(sum by (instance, cpu) (rate(node_cpu_seconds_total{mode!~\"idle|iowait|steal\",cluster=\"$cluster\"}[$__rate_interval])))","instant":false,"legendFormat":"Real","range":true,"refId":"A"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_resource_requests{resource=\"cpu\",cluster=\"$cluster\"}) / sum(machine_cpu_cores{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Request","range":true,"refId":"C"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_resource_limits{resource=\"cpu\",cluster=\"$cluster\"}) / sum(machine_cpu_cores{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Limits","range":true,"refId":"B"}],"title":"CPU Usage","type":"bargauge"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"fixedColor":"#02bdbd","mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"#c4c4c4","value":null},{"color":"text","value":0}]},"unitScale":true},"overrides":[]},"gridPos":{"h":3,"w":2,"x":8,"y":1},"id":24,"options":{"colorMode":"value","graphMode":"none","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"10.3.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"count(count by (node) (kube_node_info))","instant":false,"legendFormat":"__auto","range":true,"refId":"A"}],"title":"Nodes","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"fixedColor":"#02bdbd","mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"text","value":null},{"color":"text","value":0}]},"unitScale":true},"overrides":[]},"gridPos":{"h":4,"w":4,"x":10,"y":1},"id":27,"options":{"colorMode":"value","graphMode":"none","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"10.3.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(rate(node_cpu_seconds_total{mode!~\"idle|iowait|steal\", cluster=\"$cluster\"}[$__rate_interval]))","instant":false,"legendFormat":"Real","range":true,"refId":"A"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_resource_requests{resource=\"cpu\", cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Request","range":true,"refId":"B"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_resource_limits{resource=\"cpu\", cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Limits","range":true,"refId":"C"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(machine_cpu_cores{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Total","range":true,"refId":"D"}],"title":"CPU Uses","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":16,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"short","unitScale":true},"overrides":[]},"gridPos":{"h":10,"w":10,"x":14,"y":1},"id":23,"options":{"legend":{"calcs":["last"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_namespace_labels{cluster=\"$cluster\"})","instant":false,"legendFormat":"Namespace","range":true,"refId":"A"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_status_running{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Running containers","range":true,"refId":"B"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_status_phase{phase=\"Running\", cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Running Pods","range":true,"refId":"C"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_endpoint_info{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Endpoints","range":true,"refId":"D"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_ingress_info{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Ingress","range":true,"refId":"E"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_deployment_labels{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Deployments","range":true,"refId":"F"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_statefulset_labels{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Statefulsets","range":true,"refId":"G"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_daemonset_labels{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Daemonset","range":true,"refId":"H"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_persistentvolumeclaim_info{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Persistent Volume Claims","range":true,"refId":"I"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_hpa_labels{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Horizontal pod autoscalers","range":true,"refId":"J"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_configmap_info{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Configmaps","range":true,"refId":"K"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_secret_info{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Secrets","range":true,"refId":"L"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_networkpolicy_labels{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Network Policies","range":true,"refId":"M"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"count(count by (node) (kube_node_info{cluster=\"$cluster\"}))","hide":false,"instant":false,"legendFormat":"Nodes","range":true,"refId":"N"}],"title":"Resource Count","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"fixedColor":"#02bdbd","mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"#ffffff","value":null},{"color":"text","value":0}]},"unitScale":true},"overrides":[]},"gridPos":{"h":3,"w":2,"x":8,"y":4},"id":25,"options":{"colorMode":"value","graphMode":"none","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"10.3.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"count(kube_namespace_created{cluster=\"$cluster\"})","instant":false,"legendFormat":"__auto","range":true,"refId":"A"}],"title":"Namespaces","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"fixedColor":"#02bdbd","mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"#f5f5f5","value":null},{"color":"text","value":0}]},"unit":"bytes","unitScale":true},"overrides":[]},"gridPos":{"h":6,"w":4,"x":10,"y":5},"id":28,"options":{"colorMode":"value","graphMode":"none","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"10.3.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(node_memory_MemTotal_bytes{cluster=\"$cluster\"} - node_memory_MemAvailable_bytes{cluster=\"$cluster\"})","instant":false,"legendFormat":"Real","range":true,"refId":"A"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_resource_requests{resource=\"memory\", cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Requests","range":true,"refId":"B"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_resource_limits{resource=\"memory\", cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Limits","range":true,"refId":"C"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(machine_memory_bytes{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Total","range":true,"refId":"D"}],"title":"Ram Usage","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"decimals":2,"mappings":[],"max":1,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"percentunit","unitScale":true},"overrides":[]},"gridPos":{"h":5,"w":8,"x":0,"y":6},"id":22,"options":{"displayMode":"lcd","maxVizHeight":300,"minVizHeight":16,"minVizWidth":8,"namePlacement":"auto","orientation":"horizontal","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showUnfilled":true,"sizing":"auto","valueMode":"color"},"pluginVersion":"10.3.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(node_memory_MemTotal_bytes{cluster=\"$cluster\"} - node_memory_MemAvailable_bytes{cluster=\"$cluster\"}) / sum(node_memory_MemTotal_bytes{cluster=\"$cluster\"})","instant":false,"legendFormat":"Real","range":true,"refId":"A"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_resource_requests{resource=\"memory\",cluster=\"$cluster\"}) / sum(machine_memory_bytes{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Request","range":true,"refId":"B"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_container_resource_limits{resource=\"memory\",cluster=\"$cluster\"}) / sum(machine_memory_bytes{cluster=\"$cluster\"})","hide":false,"instant":false,"legendFormat":"Limits","range":true,"refId":"C"}],"title":"Memory Usage","type":"bargauge"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"fixedColor":"#02bdbd","mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"#eff5ef","value":null},{"color":"text","value":0}]},"unitScale":true},"overrides":[]},"gridPos":{"h":4,"w":2,"x":8,"y":7},"id":26,"options":{"colorMode":"value","graphMode":"none","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"10.3.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(kube_pod_status_phase{phase=\"Running\", cluster=\"$cluster\"})","instant":false,"legendFormat":"__auto","range":true,"refId":"A"}],"title":"Running pods","type":"stat"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":11},"id":29,"panels":[],"title":"Resources","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineStyle":{"fill":"solid"},"lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"decimals":2,"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"#EAB839","value":0.5},{"color":"red","value":0.7}]},"unit":"percentunit","unitScale":true},"overrides":[]},"gridPos":{"h":7,"w":12,"x":0,"y":12},"id":30,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","exemplar":true,"expr":"avg(sum by (instance, cpu) (rate(node_cpu_seconds_total{mode!~\"idle|iowait|steal\", cluster=\"$cluster\"}[$__rate_interval])))","instant":false,"legendFormat":"__auto","range":true,"refId":"A"}],"title":"Cluster CPU Utilization","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineStyle":{"fill":"solid"},"lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"decimals":2,"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"#EAB839","value":0.5},{"color":"red","value":0.7}]},"unit":"percentunit","unitScale":true},"overrides":[]},"gridPos":{"h":7,"w":12,"x":12,"y":12},"id":31,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","exemplar":true,"expr":"sum(node_memory_MemTotal_bytes{cluster=\"$cluster\"} - node_memory_MemAvailable_bytes{cluster=\"$cluster\"}) / sum(node_memory_MemTotal_bytes{cluster=\"$cluster\"})","instant":false,"legendFormat":"__auto","range":true,"refId":"A"}],"title":"Cluster Memory Utilization","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":7,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unitScale":true},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":19},"id":32,"options":{"legend":{"calcs":["last","min","max","mean"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(rate(container_cpu_usage_seconds_total{image!=\"\", cluster=\"$cluster\"}[$__rate_interval])) by (namespace)","instant":false,"legendFormat":"{{namespace}}","range":true,"refId":"A"}],"title":"CPU Utilization by Namespace","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":7,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"bytes","unitScale":true},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":19},"id":33,"options":{"legend":{"calcs":["last","min","max","mean"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(container_memory_working_set_bytes{image!=\"\", cluster=\"$cluster\"}) by (namespace)","instant":false,"legendFormat":"{{namespace}}","range":true,"refId":"A"}],"title":"Mmeory Utilization by Namespace","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":9,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"percentunit","unitScale":true},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":27},"id":34,"options":{"legend":{"calcs":["last","min","max","mean"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"avg(sum by (instance, cpu) (rate(node_cpu_seconds_total{mode!~\"idle|iowait|steal\", cluster=\"$cluster\"}[$__rate_interval]))) by (instance)","instant":false,"legendFormat":"{{node}}","range":true,"refId":"A"}],"title":"CPU Utilization by instance","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":9,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"bytes","unitScale":true},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":27},"id":35,"options":{"legend":{"calcs":["last","min","max","mean"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(node_memory_MemTotal_bytes{cluster=\"$cluster\"} - node_memory_MemAvailable_bytes{cluster=\"$cluster\"}) by (instance)","instant":false,"legendFormat":"{{node}}","range":true,"refId":"A"}],"title":"Mmeory Utilization by instance","type":"timeseries"}],"refresh":"5s","schemaVersion":39,"tags":[],"templating":{"list":[{"current":{"selected":false,"text":"Prometheus","value":"prometheus"},"hide":0,"includeAll":false,"multi":false,"name":"datasource","options":[],"query":"prometheus","queryValue":"","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"},{"current":{"selected":false,"text":"sigma-master","value":"sigma-master"},"datasource":{"type":"prometheus","uid":"${datasource}"},"definition":"label_values(kube_node_info,node)","hide":0,"includeAll":false,"multi":false,"name":"node","options":[],"query":{"qryType":1,"query":"label_values(kube_node_info,node)","refId":"PrometheusVariableQueryEditor-VariableQuery"},"refresh":1,"regex":"","skipUrlSync":false,"sort":1,"type":"query"},{"allValue":"","current":{"selected":false,"text":"aescloud-engine","value":"aescloud-engine"},"datasource":{"type":"prometheus","uid":"${datasource}"},"definition":"label_values(kube_namespace_created,namespace)","hide":0,"includeAll":false,"multi":false,"name":"namespace","options":[],"query":{"qryType":1,"query":"label_values(kube_namespace_created,namespace)","refId":"PrometheusVariableQueryEditor-VariableQuery"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"type":"query"},{"current":{"selected":false,"text":"172.17.17.98:9100","value":"172.17.17.98:9100"},"datasource":{"type":"prometheus","uid":"${datasource}"},"definition":"label_values(node_uname_info{nodename=~\"(?i:($node))\"},instance)","hide":2,"includeAll":false,"multi":false,"name":"instance","options":[],"query":{"qryType":1,"query":"label_values(node_uname_info{nodename=~\"(?i:($node))\"},instance)","refId":"PrometheusVariableQueryEditor-VariableQuery"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"type":"query"},{"current":{"selected":false,"text":"node","value":"node"},"hide":0,"includeAll":false,"multi":false,"name":"overview_mode","options":[{"selected":true,"text":"node","value":"node"},{"selected":false,"text":"namespace","value":"namespace"}],"query":"node, namespace","queryValue":"","skipUrlSync":false,"type":"custom"},{"current":{"isNone":true,"selected":false,"text":"None","value":""},"datasource":{"type":"prometheus","uid":"${datasource}"},"definition":"label_values(kube_node_info,cluster)","hide":0,"includeAll":false,"multi":false,"name":"cluster","options":[],"query":{"qryType":1,"query":"label_values(kube_node_info,cluster)","refId":"PrometheusVariableQueryEditor-VariableQuery"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"type":"query"}]},"time":{"from":"now-5m","to":"now"},"timepicker":{},"timezone":"","title":"AES / Cluster / Overview","uid":"acc6864b-dffc-4637-b478-b2322b042c72","version":6,"weekStart":""}`}}
{{- end }}