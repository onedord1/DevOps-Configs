[2025-08-07 09:39:01] Starting Ansible database migration script
[2025-08-07 09:39:01] Installing Python virtual environment...
[2025-08-07 09:39:02] Creating Python virtual environment...
[2025-08-07 09:39:03] Activating virtual environment...
[2025-08-07 09:39:03] Upgrading pip...
[2025-08-07 09:39:04] Installing required Python packages...
[2025-08-07 09:39:04] Running Ansible playbook...
ansible-playbook [core 2.18.7]
  config file = /home/you/Desktop/ansible_db_migration_scripts/ansible.cfg
  configured module search path = ['/home/you/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /home/you/ansible-venv/lib/python3.12/site-packages/ansible
  ansible collection location = /home/you/.ansible/collections:/usr/share/ansible/collections
  executable location = /home/you/ansible-venv/bin/ansible-playbook
  python version = 3.12.3 (main, Jun 18 2025, 17:59:45) [GCC 13.3.0] (/home/you/ansible-venv/bin/python3)
  jinja version = 3.1.6
  libyaml = True
Using /home/you/Desktop/ansible_db_migration_scripts/ansible.cfg as config file
host_list declined parsing /home/you/Desktop/ansible_db_migration_scripts/inventories/var.ini as it did not pass its verify_file() method
script declined parsing /home/you/Desktop/ansible_db_migration_scripts/inventories/var.ini as it did not pass its verify_file() method
auto declined parsing /home/you/Desktop/ansible_db_migration_scripts/inventories/var.ini as it did not pass its verify_file() method
yaml declined parsing /home/you/Desktop/ansible_db_migration_scripts/inventories/var.ini as it did not pass its verify_file() method
Parsed /home/you/Desktop/ansible_db_migration_scripts/inventories/var.ini inventory source with ini plugin
Skipping callback 'default', as we already have a stdout callback.
Skipping callback 'minimal', as we already have a stdout callback.
Skipping callback 'oneline', as we already have a stdout callback.

PLAYBOOK: main.yaml ************************************************************
1 plays in /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml

PLAY [local] *******************************************************************

TASK [Group flat variables into structured dicts] ******************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:10
ok: [localhost] => {
    "censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result",
    "changed": false
}

TASK [Debug loaded variables] **************************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:38
ok: [localhost] => {
    "msg": [
        "db_type = postgres",
        "source host = 172.17.17.160, db name = corteza",
        "target host = 172.17.17.163, db name = corteza"
    ]
}

TASK [Build dynamic dump filenames for source and target] **********************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:45
ok: [localhost] => {
    "ansible_facts": {
        "dump_file_source": "../dumps/corteza_from_172.17.17.160.dump",
        "dump_file_target": "../dumps/corteza_from_172.17.17.163.dump"
    },
    "changed": false
}

TASK [Show dump filenames] *****************************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:58
[WARNING]: Found variable using reserved name: namespace
ok: [localhost] => {
    "msg": {
        "source_dump": "../dumps/corteza_from_172.17.17.160.dump",
        "target_dump": "../dumps/corteza_from_172.17.17.163.dump"
    }
}

TASK [include_role : ../roles/common-scale] ************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:65
included: ../roles/common-scale for localhost

TASK [../roles/common-scale : Scale down OrgPod backend replicas] **************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/common-scale/tasks/replica-down.yaml:1
[WARNING]: Platform linux on host localhost is using the discovered Python
interpreter at /home/you/ansible-venv/bin/python3.12, but future installation
of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754537944.7241552-24794-70864419517887 `" && echo ansible-tmp-1754537944.7241552-24794-70864419517887="` echo /home/you/.ansible/tmp/ansible-tmp-1754537944.7241552-24794-70864419517887 `" ) && sleep 0'
<localhost> Attempting python interpreter discovery
<localhost> EXEC /bin/sh -c 'echo PLATFORM; uname; echo FOUND; command -v '"'"'python3.13'"'"'; command -v '"'"'python3.12'"'"'; command -v '"'"'python3.11'"'"'; command -v '"'"'python3.10'"'"'; command -v '"'"'python3.9'"'"'; command -v '"'"'python3.8'"'"'; command -v '"'"'/usr/bin/python3'"'"'; command -v '"'"'python3'"'"'; echo ENDFOUND && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 && sleep 0'
<localhost> Python interpreter discovery fallback (unsupported Linux distribution: ubuntu)
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible_collections/kubernetes/core/plugins/modules/k8s.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpay7fzeyv TO /home/you/.ansible/tmp/ansible-tmp-1754537944.7241552-24794-70864419517887/AnsiballZ_k8s.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754537944.7241552-24794-70864419517887/ /home/you/.ansible/tmp/ansible-tmp-1754537944.7241552-24794-70864419517887/AnsiballZ_k8s.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754537944.7241552-24794-70864419517887/AnsiballZ_k8s.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754537944.7241552-24794-70864419517887/ > /dev/null 2>&1 && sleep 0'
ok: [localhost] => {
    "ansible_facts": {
        "discovered_interpreter_python": "/home/you/ansible-venv/bin/python3.12"
    },
    "changed": false,
    "invocation": {
        "module_args": {
            "api_key": null,
            "api_version": "v1",
            "append_hash": false,
            "apply": false,
            "ca_cert": null,
            "client_cert": null,
            "client_key": null,
            "context": null,
            "continue_on_error": false,
            "definition": {
                "apiVersion": "webapp.aes.dev/v1",
                "kind": "OrgPod",
                "metadata": {
                    "name": "cortezapod",
                    "namespace": "cortezadevops-dev-mhoi-ns"
                },
                "spec": {
                    "backendReplicas": 0
                }
            },
            "delete_all": false,
            "delete_options": null,
            "force": false,
            "generate_name": null,
            "hidden_fields": null,
            "host": null,
            "impersonate_groups": null,
            "impersonate_user": null,
            "kind": null,
            "kubeconfig": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "label_selectors": null,
            "merge_type": null,
            "name": null,
            "namespace": "cortezadevops-dev-mhoi-ns",
            "no_proxy": null,
            "password": null,
            "persist_config": null,
            "proxy": null,
            "proxy_headers": null,
            "resource_definition": {
                "apiVersion": "webapp.aes.dev/v1",
                "kind": "OrgPod",
                "metadata": {
                    "name": "cortezapod",
                    "namespace": "cortezadevops-dev-mhoi-ns"
                },
                "spec": {
                    "backendReplicas": 0
                }
            },
            "server_side_apply": null,
            "src": null,
            "state": "present",
            "template": null,
            "username": null,
            "validate": null,
            "validate_certs": null,
            "wait": false,
            "wait_condition": null,
            "wait_sleep": 5,
            "wait_timeout": 120
        }
    },
    "method": "update",
    "result": {
        "apiVersion": "webapp.aes.dev/v1",
        "kind": "OrgPod",
        "metadata": {
            "creationTimestamp": "2025-05-27T05:41:05Z",
            "finalizers": [
                "k8s.io/aesorg"
            ],
            "generation": 74,
            "managedFields": [
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:status": {
                            ".": {},
                            "f:ready": {},
                            "f:states": {}
                        }
                    },
                    "manager": "manager",
                    "operation": "Update",
                    "subresource": "status",
                    "time": "2025-05-27T05:41:06Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            ".": {},
                            "f:host": {},
                            "f:path": {},
                            "f:port": {},
                            "f:pvSize": {}
                        }
                    },
                    "manager": "cgornd",
                    "operation": "Update",
                    "time": "2025-06-01T06:07:11Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:metadata": {
                            "f:finalizers": {
                                ".": {},
                                "v:\"k8s.io/aesorg\"": {}
                            }
                        }
                    },
                    "manager": "manager",
                    "operation": "Update",
                    "time": "2025-06-01T06:07:11Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            "f:environmentVariables": {},
                            "f:orgImg": {}
                        }
                    },
                    "manager": "kubectl-edit",
                    "operation": "Update",
                    "time": "2025-06-26T05:28:52Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            "f:backendReplicas": {}
                        }
                    },
                    "manager": "OpenAPI-Generator",
                    "operation": "Update",
                    "time": "2025-08-06T07:19:05Z"
                }
            ],
            "name": "cortezapod",
            "namespace": "cortezadevops-dev-mhoi-ns",
            "resourceVersion": "36393618",
            "uid": "d811238d-c7a0-40c5-9bfc-f8774904fd16"
        },
        "spec": {
            "backendReplicas": 0,
            "environmentVariables": [
                {
                    "name": "DOMAIN",
                    "value": "172.17.17.160"
                },
                {
                    "name": "SMTP_HOST",
                    "value": "mail.smtp2go.com"
                },
                {
                    "name": "SMTP_PORT",
                    "value": "465"
                },
                {
                    "name": "SMTP_USER",
                    "value": "cortezauser"
                },
                {
                    "name": "SMTP_PASS",
                    "value": "3a3igTLqGx8iMkXe"
                },
                {
                    "name": "SMTP_FROM",
                    "value": "donotreply@quickops.io"
                },
                {
                    "name": "SMTP_SECURE",
                    "value": "true"
                },
                {
                    "name": "SMTP_AUTH_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ENVIRONMENT",
                    "value": "production"
                },
                {
                    "name": "VERSION",
                    "value": "2024.1"
                },
                {
                    "name": "DB_DSN",
                    "value": "postgres://rootuser:superAdmin@cortezadb-db-cluster:5432/corteza?sslmode=require"
                },
                {
                    "name": "HTTP_WEBAPP_ENABLED",
                    "value": "true"
                },
                {
                    "name": "AUTH_GARBAGE_COLLECTOR_INTERVAL",
                    "value": "60min"
                },
                {
                    "name": "ACTIONLOG_ENABLED",
                    "value": "true"
                },
                {
                    "name": "AUTH_REQUEST_RATE_LIMIT",
                    "value": "600000"
                },
                {
                    "name": "AUTH_REQUEST_RATE_WINDOW_LENGTH",
                    "value": "600000m"
                },
                {
                    "name": "DB_MAX_OPEN_CONNS",
                    "value": "6000"
                },
                {
                    "name": "DB_MAX_IDLE_CONNS",
                    "value": "300"
                },
                {
                    "name": "AUTH_DEVELOPMENT_MODE",
                    "value": "false"
                },
                {
                    "name": "SESSION_COOKIE_SECURE",
                    "value": "true"
                },
                {
                    "name": "HOSTNAME",
                    "value": "172.17.17.160"
                },
                {
                    "name": "HTTP_SECURE",
                    "value": "true"
                },
                {
                    "name": "AUTH_CSRF_ENABLED",
                    "value": "false"
                },
                {
                    "name": "EVENTBUS_SCHEDULER_ENABLED",
                    "value": "true"
                },
                {
                    "name": "EVENTBUS_SCHEDULER_INTERVAL",
                    "value": "180s"
                },
                {
                    "name": "LOCALE_LOG",
                    "value": "ture"
                },
                {
                    "name": "LOG_DEBUG",
                    "value": "ture"
                },
                {
                    "name": "UPGRADE_DEBUG",
                    "value": "true"
                }
            ],
            "host": true,
            "orgImg": "registry.cloudaes.com/corteza/anwarsales_cementsheet_corteza:1.19",
            "path": "/data",
            "port": 80,
            "pvSize": 5000
        },
        "status": {
            "ready": true,
            "states": [
                {
                    "message": "Orgpod backend is ready",
                    "metadata": {},
                    "reason": "All replicas are ready"
                }
            ]
        }
    }
}

TASK [include_tasks] ***********************************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:73
included: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/create-source-db-dump.yaml for localhost

TASK [Create dump source PostgreSQL DB] ****************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/create-source-db-dump.yaml:1
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754537945.2696767-24830-240962642545837 `" && echo ansible-tmp-1754537945.2696767-24830-240962642545837="` echo /home/you/.ansible/tmp/ansible-tmp-1754537945.2696767-24830-240962642545837 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/command.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpm_eslp5_ TO /home/you/.ansible/tmp/ansible-tmp-1754537945.2696767-24830-240962642545837/AnsiballZ_command.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754537945.2696767-24830-240962642545837/ /home/you/.ansible/tmp/ansible-tmp-1754537945.2696767-24830-240962642545837/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754537945.2696767-24830-240962642545837/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754537945.2696767-24830-240962642545837/ > /dev/null 2>&1 && sleep 0'
changed: [localhost] => {
    "changed": true,
    "cmd": "PGPASSWORD='superAdmin' pg_dump -h 172.17.17.160 -p 15432 -U rootuser -Fc corteza -f \"../dumps/corteza_from_172.17.17.160.dump\"\n",
    "delta": "0:00:27.019437",
    "end": "2025-08-07 09:39:32.439565",
    "invocation": {
        "module_args": {
            "_raw_params": "PGPASSWORD='superAdmin' pg_dump -h 172.17.17.160 -p 15432 -U rootuser -Fc corteza -f \"../dumps/corteza_from_172.17.17.160.dump\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2025-08-07 09:39:05.420128",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "",
    "stdout_lines": []
}

TASK [Debug dump path for source] **********************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/create-source-db-dump.yaml:5
ok: [localhost] => {
    "msg": "Dump file created at ../dumps/corteza_from_172.17.17.160.dump"
}

TASK [include_role : ../roles/common-scale] ************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:75
included: ../roles/common-scale for localhost

TASK [../roles/common-scale : Scale up OrgPod backend replicas] ****************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/common-scale/tasks/replica-up.yaml:1
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754537972.5263958-24978-9116621900534 `" && echo ansible-tmp-1754537972.5263958-24978-9116621900534="` echo /home/you/.ansible/tmp/ansible-tmp-1754537972.5263958-24978-9116621900534 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible_collections/kubernetes/core/plugins/modules/k8s.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpeo4s8_i_ TO /home/you/.ansible/tmp/ansible-tmp-1754537972.5263958-24978-9116621900534/AnsiballZ_k8s.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754537972.5263958-24978-9116621900534/ /home/you/.ansible/tmp/ansible-tmp-1754537972.5263958-24978-9116621900534/AnsiballZ_k8s.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754537972.5263958-24978-9116621900534/AnsiballZ_k8s.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754537972.5263958-24978-9116621900534/ > /dev/null 2>&1 && sleep 0'
changed: [localhost] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "api_key": null,
            "api_version": "v1",
            "append_hash": false,
            "apply": false,
            "ca_cert": null,
            "client_cert": null,
            "client_key": null,
            "context": null,
            "continue_on_error": false,
            "definition": {
                "apiVersion": "webapp.aes.dev/v1",
                "kind": "OrgPod",
                "metadata": {
                    "name": "cortezapod",
                    "namespace": "cortezadevops-dev-mhoi-ns"
                },
                "spec": {
                    "backendReplicas": 1
                }
            },
            "delete_all": false,
            "delete_options": null,
            "force": false,
            "generate_name": null,
            "hidden_fields": null,
            "host": null,
            "impersonate_groups": null,
            "impersonate_user": null,
            "kind": null,
            "kubeconfig": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "label_selectors": null,
            "merge_type": null,
            "name": null,
            "namespace": "cortezadevops-dev-mhoi-ns",
            "no_proxy": null,
            "password": null,
            "persist_config": null,
            "proxy": null,
            "proxy_headers": null,
            "resource_definition": {
                "apiVersion": "webapp.aes.dev/v1",
                "kind": "OrgPod",
                "metadata": {
                    "name": "cortezapod",
                    "namespace": "cortezadevops-dev-mhoi-ns"
                },
                "spec": {
                    "backendReplicas": 1
                }
            },
            "server_side_apply": null,
            "src": null,
            "state": "present",
            "template": null,
            "username": null,
            "validate": null,
            "validate_certs": null,
            "wait": false,
            "wait_condition": null,
            "wait_sleep": 5,
            "wait_timeout": 120
        }
    },
    "method": "update",
    "result": {
        "apiVersion": "webapp.aes.dev/v1",
        "kind": "OrgPod",
        "metadata": {
            "creationTimestamp": "2025-05-27T05:41:05Z",
            "finalizers": [
                "k8s.io/aesorg"
            ],
            "generation": 75,
            "managedFields": [
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:status": {
                            ".": {},
                            "f:ready": {},
                            "f:states": {}
                        }
                    },
                    "manager": "manager",
                    "operation": "Update",
                    "subresource": "status",
                    "time": "2025-05-27T05:41:06Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            ".": {},
                            "f:host": {},
                            "f:path": {},
                            "f:port": {},
                            "f:pvSize": {}
                        }
                    },
                    "manager": "cgornd",
                    "operation": "Update",
                    "time": "2025-06-01T06:07:11Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:metadata": {
                            "f:finalizers": {
                                ".": {},
                                "v:\"k8s.io/aesorg\"": {}
                            }
                        }
                    },
                    "manager": "manager",
                    "operation": "Update",
                    "time": "2025-06-01T06:07:11Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            "f:environmentVariables": {},
                            "f:orgImg": {}
                        }
                    },
                    "manager": "kubectl-edit",
                    "operation": "Update",
                    "time": "2025-06-26T05:28:52Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            "f:backendReplicas": {}
                        }
                    },
                    "manager": "OpenAPI-Generator",
                    "operation": "Update",
                    "time": "2025-08-07T03:39:32Z"
                }
            ],
            "name": "cortezapod",
            "namespace": "cortezadevops-dev-mhoi-ns",
            "resourceVersion": "36823415",
            "uid": "d811238d-c7a0-40c5-9bfc-f8774904fd16"
        },
        "spec": {
            "backendReplicas": 1,
            "environmentVariables": [
                {
                    "name": "DOMAIN",
                    "value": "172.17.17.160"
                },
                {
                    "name": "SMTP_HOST",
                    "value": "mail.smtp2go.com"
                },
                {
                    "name": "SMTP_PORT",
                    "value": "465"
                },
                {
                    "name": "SMTP_USER",
                    "value": "cortezauser"
                },
                {
                    "name": "SMTP_PASS",
                    "value": "3a3igTLqGx8iMkXe"
                },
                {
                    "name": "SMTP_FROM",
                    "value": "donotreply@quickops.io"
                },
                {
                    "name": "SMTP_SECURE",
                    "value": "true"
                },
                {
                    "name": "SMTP_AUTH_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ENVIRONMENT",
                    "value": "production"
                },
                {
                    "name": "VERSION",
                    "value": "2024.1"
                },
                {
                    "name": "DB_DSN",
                    "value": "postgres://rootuser:superAdmin@cortezadb-db-cluster:5432/corteza?sslmode=require"
                },
                {
                    "name": "HTTP_WEBAPP_ENABLED",
                    "value": "true"
                },
                {
                    "name": "AUTH_GARBAGE_COLLECTOR_INTERVAL",
                    "value": "60min"
                },
                {
                    "name": "ACTIONLOG_ENABLED",
                    "value": "true"
                },
                {
                    "name": "AUTH_REQUEST_RATE_LIMIT",
                    "value": "600000"
                },
                {
                    "name": "AUTH_REQUEST_RATE_WINDOW_LENGTH",
                    "value": "600000m"
                },
                {
                    "name": "DB_MAX_OPEN_CONNS",
                    "value": "6000"
                },
                {
                    "name": "DB_MAX_IDLE_CONNS",
                    "value": "300"
                },
                {
                    "name": "AUTH_DEVELOPMENT_MODE",
                    "value": "false"
                },
                {
                    "name": "SESSION_COOKIE_SECURE",
                    "value": "true"
                },
                {
                    "name": "HOSTNAME",
                    "value": "172.17.17.160"
                },
                {
                    "name": "HTTP_SECURE",
                    "value": "true"
                },
                {
                    "name": "AUTH_CSRF_ENABLED",
                    "value": "false"
                },
                {
                    "name": "EVENTBUS_SCHEDULER_ENABLED",
                    "value": "true"
                },
                {
                    "name": "EVENTBUS_SCHEDULER_INTERVAL",
                    "value": "180s"
                },
                {
                    "name": "LOCALE_LOG",
                    "value": "ture"
                },
                {
                    "name": "LOG_DEBUG",
                    "value": "ture"
                },
                {
                    "name": "UPGRADE_DEBUG",
                    "value": "true"
                }
            ],
            "host": true,
            "orgImg": "registry.cloudaes.com/corteza/anwarsales_cementsheet_corteza:1.19",
            "path": "/data",
            "port": 80,
            "pvSize": 5000
        },
        "status": {
            "ready": true,
            "states": [
                {
                    "message": "Orgpod backend is ready",
                    "metadata": {},
                    "reason": "All replicas are ready"
                }
            ]
        }
    }
}

TASK [include_role : ../roles/common-scale] ************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:84
included: ../roles/common-scale for localhost

TASK [../roles/common-scale : Scale down OrgPod backend replicas] **************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/common-scale/tasks/replica-down.yaml:1
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754537972.9727364-25006-175050965866420 `" && echo ansible-tmp-1754537972.9727364-25006-175050965866420="` echo /home/you/.ansible/tmp/ansible-tmp-1754537972.9727364-25006-175050965866420 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible_collections/kubernetes/core/plugins/modules/k8s.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpjph4ujrk TO /home/you/.ansible/tmp/ansible-tmp-1754537972.9727364-25006-175050965866420/AnsiballZ_k8s.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754537972.9727364-25006-175050965866420/ /home/you/.ansible/tmp/ansible-tmp-1754537972.9727364-25006-175050965866420/AnsiballZ_k8s.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754537972.9727364-25006-175050965866420/AnsiballZ_k8s.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754537972.9727364-25006-175050965866420/ > /dev/null 2>&1 && sleep 0'
changed: [localhost] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "api_key": null,
            "api_version": "v1",
            "append_hash": false,
            "apply": false,
            "ca_cert": null,
            "client_cert": null,
            "client_key": null,
            "context": null,
            "continue_on_error": false,
            "definition": {
                "apiVersion": "webapp.aes.dev/v1",
                "kind": "OrgPod",
                "metadata": {
                    "name": "cortezapod",
                    "namespace": "cortezadevops-qa-ofzt-ns"
                },
                "spec": {
                    "backendReplicas": 0
                }
            },
            "delete_all": false,
            "delete_options": null,
            "force": false,
            "generate_name": null,
            "hidden_fields": null,
            "host": null,
            "impersonate_groups": null,
            "impersonate_user": null,
            "kind": null,
            "kubeconfig": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "label_selectors": null,
            "merge_type": null,
            "name": null,
            "namespace": "cortezadevops-qa-ofzt-ns",
            "no_proxy": null,
            "password": null,
            "persist_config": null,
            "proxy": null,
            "proxy_headers": null,
            "resource_definition": {
                "apiVersion": "webapp.aes.dev/v1",
                "kind": "OrgPod",
                "metadata": {
                    "name": "cortezapod",
                    "namespace": "cortezadevops-qa-ofzt-ns"
                },
                "spec": {
                    "backendReplicas": 0
                }
            },
            "server_side_apply": null,
            "src": null,
            "state": "present",
            "template": null,
            "username": null,
            "validate": null,
            "validate_certs": null,
            "wait": false,
            "wait_condition": null,
            "wait_sleep": 5,
            "wait_timeout": 120
        }
    },
    "method": "update",
    "result": {
        "apiVersion": "webapp.aes.dev/v1",
        "kind": "OrgPod",
        "metadata": {
            "creationTimestamp": "2025-08-06T05:54:36Z",
            "finalizers": [
                "k8s.io/aesorg"
            ],
            "generation": 17,
            "managedFields": [
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            ".": {},
                            "f:host": {},
                            "f:path": {},
                            "f:port": {},
                            "f:pvSize": {}
                        }
                    },
                    "manager": "cgornd",
                    "operation": "Update",
                    "time": "2025-08-06T05:54:36Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:metadata": {
                            "f:finalizers": {
                                ".": {},
                                "v:\"k8s.io/aesorg\"": {}
                            }
                        }
                    },
                    "manager": "manager",
                    "operation": "Update",
                    "time": "2025-08-06T05:54:36Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:status": {
                            ".": {},
                            "f:ready": {},
                            "f:states": {}
                        }
                    },
                    "manager": "manager",
                    "operation": "Update",
                    "subresource": "status",
                    "time": "2025-08-06T05:54:36Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            "f:environmentVariables": {},
                            "f:orgImg": {}
                        }
                    },
                    "manager": "kubectl-edit",
                    "operation": "Update",
                    "time": "2025-08-07T03:17:59Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            "f:backendReplicas": {}
                        }
                    },
                    "manager": "OpenAPI-Generator",
                    "operation": "Update",
                    "time": "2025-08-07T03:39:33Z"
                }
            ],
            "name": "cortezapod",
            "namespace": "cortezadevops-qa-ofzt-ns",
            "resourceVersion": "36823436",
            "uid": "b906fda3-872e-4a78-90b8-96d61ae2fef4"
        },
        "spec": {
            "backendReplicas": 0,
            "environmentVariables": [
                {
                    "name": "DOMAIN",
                    "value": "172.17.17.163"
                },
                {
                    "name": "SMTP_HOST",
                    "value": "mail.smtp2go.com"
                },
                {
                    "name": "SMTP_PORT",
                    "value": "465"
                },
                {
                    "name": "SMTP_USER",
                    "value": "cortezauser"
                },
                {
                    "name": "SMTP_PASS",
                    "value": "3a3igTLqGx8iMkXe"
                },
                {
                    "name": "SMTP_FROM",
                    "value": "donotreply@quickops.io"
                },
                {
                    "name": "SMTP_SECURE",
                    "value": "true"
                },
                {
                    "name": "SMTP_AUTH_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ENVIRONMENT",
                    "value": "production"
                },
                {
                    "name": "VERSION",
                    "value": "2024.9"
                },
                {
                    "name": "DB_DSN",
                    "value": "postgres://rootuser:superAdmin@cortezadbtest-db-cluster:5432/corteza?sslmode=require"
                },
                {
                    "name": "HTTP_WEBAPP_ENABLED",
                    "value": "true"
                },
                {
                    "name": "AUTH_GARBAGE_COLLECTOR_INTERVAL",
                    "value": "60min"
                },
                {
                    "name": "ACTIONLOG_ENABLED",
                    "value": "true"
                },
                {
                    "name": "AUTH_REQUEST_RATE_LIMIT",
                    "value": "600000"
                },
                {
                    "name": "AUTH_REQUEST_RATE_WINDOW_LENGTH",
                    "value": "600000m"
                },
                {
                    "name": "DB_MAX_OPEN_CONNS",
                    "value": "6000"
                },
                {
                    "name": "DB_MAX_IDLE_CONNS",
                    "value": "300"
                },
                {
                    "name": "AUTH_DEVELOPMENT_MODE",
                    "value": "false"
                },
                {
                    "name": "SESSION_COOKIE_SECURE",
                    "value": "true"
                },
                {
                    "name": "HOSTNAME",
                    "value": "172.17.17.163"
                },
                {
                    "name": "HTTP_SECURE",
                    "value": "true"
                },
                {
                    "name": "AUTH_CSRF_ENABLED",
                    "value": "false"
                },
                {
                    "name": "EVENTBUS_SCHEDULER_ENABLED",
                    "value": "true"
                },
                {
                    "name": "EVENTBUS_SCHEDULER_INTERVAL",
                    "value": "180s"
                },
                {
                    "name": "LOCALE_LOG",
                    "value": "true"
                },
                {
                    "name": "APIGW_LOG_REQUESTBODY",
                    "value": "true"
                },
                {
                    "name": "APIGW_LOG_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ACTIONLOG_WORKFLOW_FUNCTIONS_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ACTIONLOG_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ACTIONLOG_DEBUG",
                    "value": "true"
                }
            ],
            "host": true,
            "orgImg": "devopsaes/corteza:1.38",
            "path": "/data",
            "port": 80,
            "pvSize": 5000
        },
        "status": {
            "ready": true,
            "states": [
                {
                    "message": "Orgpod backend is ready",
                    "metadata": {},
                    "reason": "All replicas are ready"
                }
            ]
        }
    }
}

TASK [include_tasks] ***********************************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:92
included: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/create-target-db-dump.yaml for localhost

TASK [Create dump target PostgreSQL DB] ****************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/create-target-db-dump.yaml:1
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754537973.4112132-25034-244259809177124 `" && echo ansible-tmp-1754537973.4112132-25034-244259809177124="` echo /home/you/.ansible/tmp/ansible-tmp-1754537973.4112132-25034-244259809177124 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/command.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpxd0dj_jx TO /home/you/.ansible/tmp/ansible-tmp-1754537973.4112132-25034-244259809177124/AnsiballZ_command.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754537973.4112132-25034-244259809177124/ /home/you/.ansible/tmp/ansible-tmp-1754537973.4112132-25034-244259809177124/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754537973.4112132-25034-244259809177124/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754537973.4112132-25034-244259809177124/ > /dev/null 2>&1 && sleep 0'
changed: [localhost] => {
    "changed": true,
    "cmd": "PGPASSWORD='superAdmin' pg_dump -h 172.17.17.163 -p 5432 -U rootuser -Fc corteza -f \"../dumps/corteza_from_172.17.17.163.dump\"\n",
    "delta": "0:00:27.916916",
    "end": "2025-08-07 09:40:01.432269",
    "invocation": {
        "module_args": {
            "_raw_params": "PGPASSWORD='superAdmin' pg_dump -h 172.17.17.163 -p 5432 -U rootuser -Fc corteza -f \"../dumps/corteza_from_172.17.17.163.dump\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "",
    "rc": 0,
    "start": "2025-08-07 09:39:33.515353",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "",
    "stdout_lines": []
}

TASK [Debug dump path for target] **********************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/create-target-db-dump.yaml:5
ok: [localhost] => {
    "msg": "Dump file created at ../dumps/corteza_from_172.17.17.163.dump"
}

TASK [include_tasks] ***********************************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:94
included: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/clean-target-db.yaml for localhost

TASK [Drop target PostgreSQL database] *****************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/clean-target-db.yaml:1
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538001.4826643-25188-22391187023979 `" && echo ansible-tmp-1754538001.4826643-25188-22391187023979="` echo /home/you/.ansible/tmp/ansible-tmp-1754538001.4826643-25188-22391187023979 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible_collections/community/postgresql/plugins/modules/postgresql_db.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmp9v34ht9a TO /home/you/.ansible/tmp/ansible-tmp-1754538001.4826643-25188-22391187023979/AnsiballZ_postgresql_db.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538001.4826643-25188-22391187023979/ /home/you/.ansible/tmp/ansible-tmp-1754538001.4826643-25188-22391187023979/AnsiballZ_postgresql_db.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538001.4826643-25188-22391187023979/AnsiballZ_postgresql_db.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538001.4826643-25188-22391187023979/ > /dev/null 2>&1 && sleep 0'
changed: [localhost] => {
    "changed": true,
    "db": "corteza",
    "executed_commands": [
        "DROP DATABASE \"corteza\""
    ],
    "invocation": {
        "module_args": {
            "ca_cert": null,
            "comment": null,
            "conn_limit": "",
            "connect_params": {},
            "db": "postgres",
            "dump_extra_args": null,
            "encoding": "",
            "force": false,
            "icu_locale": "",
            "lc_collate": "",
            "lc_ctype": "",
            "locale_provider": "",
            "login_host": "172.17.17.163",
            "login_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "login_port": "5432",
            "login_unix_socket": "",
            "login_user": "rootuser",
            "maintenance_db": "postgres",
            "name": "corteza",
            "owner": "",
            "port": 5432,
            "session_role": null,
            "ssl_cert": null,
            "ssl_key": null,
            "ssl_mode": "prefer",
            "state": "absent",
            "tablespace": "",
            "target": "",
            "target_opts": "",
            "template": "",
            "trust_input": true
        }
    }
}

TASK [Create target PostgreSQL database] ***************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/clean-target-db.yaml:10
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.0102944-25219-167519650731219 `" && echo ansible-tmp-1754538002.0102944-25219-167519650731219="` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.0102944-25219-167519650731219 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible_collections/community/postgresql/plugins/modules/postgresql_db.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmp8g0f5liv TO /home/you/.ansible/tmp/ansible-tmp-1754538002.0102944-25219-167519650731219/AnsiballZ_postgresql_db.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538002.0102944-25219-167519650731219/ /home/you/.ansible/tmp/ansible-tmp-1754538002.0102944-25219-167519650731219/AnsiballZ_postgresql_db.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538002.0102944-25219-167519650731219/AnsiballZ_postgresql_db.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538002.0102944-25219-167519650731219/ > /dev/null 2>&1 && sleep 0'
changed: [localhost] => {
    "changed": true,
    "db": "corteza",
    "executed_commands": [
        "CREATE DATABASE \"corteza\" OWNER \"rootuser\" ENCODING 'UTF8'"
    ],
    "invocation": {
        "module_args": {
            "ca_cert": null,
            "comment": null,
            "conn_limit": "",
            "connect_params": {},
            "db": "postgres",
            "dump_extra_args": null,
            "encoding": "UTF8",
            "force": false,
            "icu_locale": "",
            "lc_collate": "",
            "lc_ctype": "",
            "locale_provider": "",
            "login_host": "172.17.17.163",
            "login_password": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "login_port": "5432",
            "login_unix_socket": "",
            "login_user": "rootuser",
            "maintenance_db": "postgres",
            "name": "corteza",
            "owner": "rootuser",
            "port": 5432,
            "session_role": null,
            "ssl_cert": null,
            "ssl_key": null,
            "ssl_mode": "prefer",
            "state": "present",
            "tablespace": "",
            "target": "",
            "target_opts": "",
            "template": "",
            "trust_input": true
        }
    }
}

TASK [include_role : ../roles/longhorn-storage-check] **************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:96
included: ../roles/longhorn-storage-check for localhost

TASK [../roles/longhorn-storage-check : Get Longhorn nodes information] ********
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/longhorn-storage-check/tasks/storage-availability.yaml:2
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.3437338-25245-14616936915980 `" && echo ansible-tmp-1754538002.3437338-25245-14616936915980="` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.3437338-25245-14616936915980 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/uri.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmp_ul857ya TO /home/you/.ansible/tmp/ansible-tmp-1754538002.3437338-25245-14616936915980/AnsiballZ_uri.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538002.3437338-25245-14616936915980/ /home/you/.ansible/tmp/ansible-tmp-1754538002.3437338-25245-14616936915980/AnsiballZ_uri.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538002.3437338-25245-14616936915980/AnsiballZ_uri.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538002.3437338-25245-14616936915980/ > /dev/null 2>&1 && sleep 0'
ok: [localhost] => {
    "changed": false,
    "connection": "close",
    "content": "{\"data\":[{\"actions\":{\"diskUpdate\":\"http://172.17.17.155:32657/v1/nodes/worker-1?action=diskUpdate\"},\"address\":\"192.168.226.97\",\"allowScheduling\":true,\"autoEvicting\":false,\"conditions\":{\"KernelModulesLoaded\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:02Z\",\"message\":\"Kernel modules [dm_crypt] are not loaded\",\"reason\":\"KernelModulesNotLoaded\",\"status\":\"False\",\"type\":\"KernelModulesLoaded\"},\"MountPropagation\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:32Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"MountPropagation\"},\"Multipathd\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:02Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Multipathd\"},\"NFSClientInstalled\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:02Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"NFSClientInstalled\"},\"Ready\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-08-06T05:49:46Z\",\"message\":\"Node worker-1 is ready\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Ready\"},\"RequiredPackages\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:02Z\",\"message\":\"All required packages [dmsetup nfs-common open-iscsi cryptsetup] are installed\",\"reason\":\"\",\"status\":\"True\",\"type\":\"RequiredPackages\"},\"Schedulable\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:02Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Schedulable\"}},\"disks\":{\"default-disk-5684ad78fcd5c40e\":{\"allowScheduling\":true,\"conditions\":{\"Ready\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:32Z\",\"message\":\"Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-1 is ready\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Ready\"},\"Schedulable\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-08-04T07:56:11Z\",\"message\":\"Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-1 is schedulable\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Schedulable\"}},\"diskDriver\":\"\",\"diskType\":\"filesystem\",\"diskUUID\":\"b315176b-61a4-4bfa-9f75-ae8a2a530190\",\"evictionRequested\":false,\"path\":\"/var/lib/longhorn/\",\"scheduledBackingImage\":{},\"scheduledReplica\":{\"pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-967908d0\":10485760000,\"pvc-25f58630-1871-4f98-8c61-029ecd3fc407-r-d7120810\":5242880000,\"pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-f39adbf4\":5242880000,\"pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-0af53656\":10485760000,\"pvc-46d0162b-eecf-476a-b23c-95c677ea50a7-r-2e40f1ad\":5242880000,\"pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-627adbe5\":10485760000,\"pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-b57514ee\":5242880000,\"pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-91c79a9b\":5242880000,\"pvc-a587da80-2755-4911-987a-fd2756524a3e-r-c6229f73\":4294967296,\"pvc-a637fc53-1a9a-489b-b415-a56dc48e1912-r-0b2fe2e5\":5242880000,\"pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-7b39913a\":2147483648,\"pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-2d273a33\":5368709120,\"pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-b0c0b372\":10485760000},\"storageAvailable\":34812723200,\"storageMaximum\":123690532864,\"storageReserved\":30866428723,\"storageScheduled\":85211480064,\"tags\":[]}},\"evictionRequested\":false,\"id\":\"worker-1\",\"instanceManagerCPURequest\":0,\"links\":{\"self\":\"http://172.17.17.155:32657/v1/nodes/worker-1\"},\"name\":\"worker-1\",\"region\":\"\",\"tags\":[],\"type\":\"node\",\"zone\":\"\"},{\"actions\":{\"diskUpdate\":\"http://172.17.17.155:32657/v1/nodes/worker-2?action=diskUpdate\"},\"address\":\"192.168.133.250\",\"allowScheduling\":true,\"autoEvicting\":false,\"conditions\":{\"KernelModulesLoaded\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:09Z\",\"message\":\"Kernel modules [dm_crypt] are not loaded\",\"reason\":\"KernelModulesNotLoaded\",\"status\":\"False\",\"type\":\"KernelModulesLoaded\"},\"MountPropagation\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:39Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"MountPropagation\"},\"Multipathd\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:09Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Multipathd\"},\"NFSClientInstalled\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:09Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"NFSClientInstalled\"},\"Ready\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-08-06T05:49:58Z\",\"message\":\"Node worker-2 is ready\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Ready\"},\"RequiredPackages\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:09Z\",\"message\":\"All required packages [open-iscsi cryptsetup dmsetup nfs-common] are installed\",\"reason\":\"\",\"status\":\"True\",\"type\":\"RequiredPackages\"},\"Schedulable\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-08-04T06:21:32Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Schedulable\"}},\"disks\":{\"default-disk-5684ad78fcd5c40e\":{\"allowScheduling\":true,\"conditions\":{\"Ready\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:39Z\",\"message\":\"Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-2 is ready\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Ready\"},\"Schedulable\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-04-22T06:31:39Z\",\"message\":\"Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-2 is schedulable\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Schedulable\"}},\"diskDriver\":\"\",\"diskType\":\"filesystem\",\"diskUUID\":\"b2f6d917-8fb4-4ddf-bf82-eb5ecce3f60b\",\"evictionRequested\":false,\"path\":\"/var/lib/longhorn/\",\"scheduledBackingImage\":{},\"scheduledReplica\":{\"pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-165198ea\":10485760000,\"pvc-25f58630-1871-4f98-8c61-029ecd3fc407-r-14f9a78e\":5242880000,\"pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-3a880fce\":5242880000,\"pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-7e356162\":10485760000,\"pvc-46d0162b-eecf-476a-b23c-95c677ea50a7-r-1a157f2a\":5242880000,\"pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-eae499eb\":10485760000,\"pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-de2a8360\":5242880000,\"pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-052d1765\":5242880000,\"pvc-a587da80-2755-4911-987a-fd2756524a3e-r-c3bf121a\":4294967296,\"pvc-a637fc53-1a9a-489b-b415-a56dc48e1912-r-5d5f0117\":5242880000,\"pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-45587f2a\":2147483648,\"pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-07451069\":5368709120,\"pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-82d4ca34\":10485760000},\"storageAvailable\":59873689600,\"storageMaximum\":123690532864,\"storageReserved\":30866428723,\"storageScheduled\":85211480064,\"tags\":[]}},\"evictionRequested\":false,\"id\":\"worker-2\",\"instanceManagerCPURequest\":0,\"links\":{\"self\":\"http://172.17.17.155:32657/v1/nodes/worker-2\"},\"name\":\"worker-2\",\"region\":\"\",\"tags\":[],\"type\":\"node\",\"zone\":\"\"},{\"actions\":{\"diskUpdate\":\"http://172.17.17.155:32657/v1/nodes/worker-3?action=diskUpdate\"},\"address\":\"192.168.97.232\",\"allowScheduling\":true,\"autoEvicting\":false,\"conditions\":{\"KernelModulesLoaded\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-06-04T10:15:42Z\",\"message\":\"Kernel modules [dm_crypt] are not loaded\",\"reason\":\"KernelModulesNotLoaded\",\"status\":\"False\",\"type\":\"KernelModulesLoaded\"},\"MountPropagation\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-06-04T10:16:12Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"MountPropagation\"},\"Multipathd\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-06-04T10:15:42Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Multipathd\"},\"NFSClientInstalled\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-06-04T10:15:42Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"NFSClientInstalled\"},\"Ready\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-08-04T07:55:44Z\",\"message\":\"Node worker-3 is ready\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Ready\"},\"RequiredPackages\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-06-04T10:15:42Z\",\"message\":\"All required packages [nfs-common open-iscsi cryptsetup dmsetup] are installed\",\"reason\":\"\",\"status\":\"True\",\"type\":\"RequiredPackages\"},\"Schedulable\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-07-29T07:53:19Z\",\"message\":\"\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Schedulable\"}},\"disks\":{\"default-disk-5684ad78fcd5c40e\":{\"allowScheduling\":true,\"conditions\":{\"Ready\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-06-04T10:16:12Z\",\"message\":\"Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-3 is ready\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Ready\"},\"Schedulable\":{\"lastProbeTime\":\"\",\"lastTransitionTime\":\"2025-06-04T10:16:12Z\",\"message\":\"Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-3 is schedulable\",\"reason\":\"\",\"status\":\"True\",\"type\":\"Schedulable\"}},\"diskDriver\":\"\",\"diskType\":\"filesystem\",\"diskUUID\":\"4c4d6347-5713-4c30-b15a-351fb0e39447\",\"evictionRequested\":false,\"path\":\"/var/lib/longhorn/\",\"scheduledBackingImage\":{},\"scheduledReplica\":{\"pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-3f5b002c\":10485760000,\"pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-1633e160\":5242880000,\"pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-52128a9c\":10485760000,\"pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-d8156730\":10485760000,\"pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-07e0ec50\":5242880000,\"pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-75171f49\":5242880000,\"pvc-a587da80-2755-4911-987a-fd2756524a3e-r-f203ec8c\":4294967296,\"pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-548c7732\":2147483648,\"pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-c24a9a32\":5368709120,\"pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-8c80baaa\":10485760000},\"storageAvailable\":47710208000,\"storageMaximum\":102888095744,\"storageReserved\":30866428723,\"storageScheduled\":69482840064,\"tags\":[]}},\"evictionRequested\":false,\"id\":\"worker-3\",\"instanceManagerCPURequest\":0,\"links\":{\"self\":\"http://172.17.17.155:32657/v1/nodes/worker-3\"},\"name\":\"worker-3\",\"region\":\"\",\"tags\":[],\"type\":\"node\",\"zone\":\"\"}],\"links\":{\"self\":\"http://172.17.17.155:32657/v1/nodes\"},\"resourceType\":\"node\",\"type\":\"collection\"}\n",
    "content_type": "application/json",
    "cookies": {},
    "cookies_string": "",
    "date": "Thu, 07 Aug 2025 03:40:02 GMT",
    "elapsed": 0,
    "invocation": {
        "module_args": {
            "attributes": null,
            "body": null,
            "body_format": "raw",
            "ca_path": null,
            "ciphers": null,
            "client_cert": null,
            "client_key": null,
            "creates": null,
            "decompress": true,
            "dest": null,
            "follow_redirects": "safe",
            "force": false,
            "force_basic_auth": false,
            "group": null,
            "headers": {},
            "http_agent": "ansible-httpget",
            "method": "GET",
            "mode": null,
            "owner": null,
            "remote_src": false,
            "removes": null,
            "return_content": true,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "status_code": [
                200
            ],
            "timeout": 30,
            "unix_socket": null,
            "unredirected_headers": [],
            "unsafe_writes": false,
            "url": "http://172.17.17.155:32657/v1/nodes",
            "url_password": null,
            "url_username": null,
            "use_gssapi": false,
            "use_netrc": true,
            "use_proxy": true,
            "validate_certs": true
        }
    },
    "json": {
        "data": [
            {
                "actions": {
                    "diskUpdate": "http://172.17.17.155:32657/v1/nodes/worker-1?action=diskUpdate"
                },
                "address": "192.168.226.97",
                "allowScheduling": true,
                "autoEvicting": false,
                "conditions": {
                    "KernelModulesLoaded": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:02Z",
                        "message": "Kernel modules [dm_crypt] are not loaded",
                        "reason": "KernelModulesNotLoaded",
                        "status": "False",
                        "type": "KernelModulesLoaded"
                    },
                    "MountPropagation": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:32Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "MountPropagation"
                    },
                    "Multipathd": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:02Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "Multipathd"
                    },
                    "NFSClientInstalled": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:02Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "NFSClientInstalled"
                    },
                    "Ready": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-08-06T05:49:46Z",
                        "message": "Node worker-1 is ready",
                        "reason": "",
                        "status": "True",
                        "type": "Ready"
                    },
                    "RequiredPackages": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:02Z",
                        "message": "All required packages [dmsetup nfs-common open-iscsi cryptsetup] are installed",
                        "reason": "",
                        "status": "True",
                        "type": "RequiredPackages"
                    },
                    "Schedulable": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:02Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "Schedulable"
                    }
                },
                "disks": {
                    "default-disk-5684ad78fcd5c40e": {
                        "allowScheduling": true,
                        "conditions": {
                            "Ready": {
                                "lastProbeTime": "",
                                "lastTransitionTime": "2025-04-22T06:31:32Z",
                                "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-1 is ready",
                                "reason": "",
                                "status": "True",
                                "type": "Ready"
                            },
                            "Schedulable": {
                                "lastProbeTime": "",
                                "lastTransitionTime": "2025-08-04T07:56:11Z",
                                "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-1 is schedulable",
                                "reason": "",
                                "status": "True",
                                "type": "Schedulable"
                            }
                        },
                        "diskDriver": "",
                        "diskType": "filesystem",
                        "diskUUID": "b315176b-61a4-4bfa-9f75-ae8a2a530190",
                        "evictionRequested": false,
                        "path": "/var/lib/longhorn/",
                        "scheduledBackingImage": {},
                        "scheduledReplica": {
                            "pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-967908d0": 10485760000,
                            "pvc-25f58630-1871-4f98-8c61-029ecd3fc407-r-d7120810": 5242880000,
                            "pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-f39adbf4": 5242880000,
                            "pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-0af53656": 10485760000,
                            "pvc-46d0162b-eecf-476a-b23c-95c677ea50a7-r-2e40f1ad": 5242880000,
                            "pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-627adbe5": 10485760000,
                            "pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-b57514ee": 5242880000,
                            "pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-91c79a9b": 5242880000,
                            "pvc-a587da80-2755-4911-987a-fd2756524a3e-r-c6229f73": 4294967296,
                            "pvc-a637fc53-1a9a-489b-b415-a56dc48e1912-r-0b2fe2e5": 5242880000,
                            "pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-7b39913a": 2147483648,
                            "pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-2d273a33": 5368709120,
                            "pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-b0c0b372": 10485760000
                        },
                        "storageAvailable": 34812723200,
                        "storageMaximum": 123690532864,
                        "storageReserved": 30866428723,
                        "storageScheduled": 85211480064,
                        "tags": []
                    }
                },
                "evictionRequested": false,
                "id": "worker-1",
                "instanceManagerCPURequest": 0,
                "links": {
                    "self": "http://172.17.17.155:32657/v1/nodes/worker-1"
                },
                "name": "worker-1",
                "region": "",
                "tags": [],
                "type": "node",
                "zone": ""
            },
            {
                "actions": {
                    "diskUpdate": "http://172.17.17.155:32657/v1/nodes/worker-2?action=diskUpdate"
                },
                "address": "192.168.133.250",
                "allowScheduling": true,
                "autoEvicting": false,
                "conditions": {
                    "KernelModulesLoaded": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:09Z",
                        "message": "Kernel modules [dm_crypt] are not loaded",
                        "reason": "KernelModulesNotLoaded",
                        "status": "False",
                        "type": "KernelModulesLoaded"
                    },
                    "MountPropagation": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:39Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "MountPropagation"
                    },
                    "Multipathd": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:09Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "Multipathd"
                    },
                    "NFSClientInstalled": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:09Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "NFSClientInstalled"
                    },
                    "Ready": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-08-06T05:49:58Z",
                        "message": "Node worker-2 is ready",
                        "reason": "",
                        "status": "True",
                        "type": "Ready"
                    },
                    "RequiredPackages": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:09Z",
                        "message": "All required packages [open-iscsi cryptsetup dmsetup nfs-common] are installed",
                        "reason": "",
                        "status": "True",
                        "type": "RequiredPackages"
                    },
                    "Schedulable": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-08-04T06:21:32Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "Schedulable"
                    }
                },
                "disks": {
                    "default-disk-5684ad78fcd5c40e": {
                        "allowScheduling": true,
                        "conditions": {
                            "Ready": {
                                "lastProbeTime": "",
                                "lastTransitionTime": "2025-04-22T06:31:39Z",
                                "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-2 is ready",
                                "reason": "",
                                "status": "True",
                                "type": "Ready"
                            },
                            "Schedulable": {
                                "lastProbeTime": "",
                                "lastTransitionTime": "2025-04-22T06:31:39Z",
                                "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-2 is schedulable",
                                "reason": "",
                                "status": "True",
                                "type": "Schedulable"
                            }
                        },
                        "diskDriver": "",
                        "diskType": "filesystem",
                        "diskUUID": "b2f6d917-8fb4-4ddf-bf82-eb5ecce3f60b",
                        "evictionRequested": false,
                        "path": "/var/lib/longhorn/",
                        "scheduledBackingImage": {},
                        "scheduledReplica": {
                            "pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-165198ea": 10485760000,
                            "pvc-25f58630-1871-4f98-8c61-029ecd3fc407-r-14f9a78e": 5242880000,
                            "pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-3a880fce": 5242880000,
                            "pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-7e356162": 10485760000,
                            "pvc-46d0162b-eecf-476a-b23c-95c677ea50a7-r-1a157f2a": 5242880000,
                            "pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-eae499eb": 10485760000,
                            "pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-de2a8360": 5242880000,
                            "pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-052d1765": 5242880000,
                            "pvc-a587da80-2755-4911-987a-fd2756524a3e-r-c3bf121a": 4294967296,
                            "pvc-a637fc53-1a9a-489b-b415-a56dc48e1912-r-5d5f0117": 5242880000,
                            "pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-45587f2a": 2147483648,
                            "pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-07451069": 5368709120,
                            "pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-82d4ca34": 10485760000
                        },
                        "storageAvailable": 59873689600,
                        "storageMaximum": 123690532864,
                        "storageReserved": 30866428723,
                        "storageScheduled": 85211480064,
                        "tags": []
                    }
                },
                "evictionRequested": false,
                "id": "worker-2",
                "instanceManagerCPURequest": 0,
                "links": {
                    "self": "http://172.17.17.155:32657/v1/nodes/worker-2"
                },
                "name": "worker-2",
                "region": "",
                "tags": [],
                "type": "node",
                "zone": ""
            },
            {
                "actions": {
                    "diskUpdate": "http://172.17.17.155:32657/v1/nodes/worker-3?action=diskUpdate"
                },
                "address": "192.168.97.232",
                "allowScheduling": true,
                "autoEvicting": false,
                "conditions": {
                    "KernelModulesLoaded": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-06-04T10:15:42Z",
                        "message": "Kernel modules [dm_crypt] are not loaded",
                        "reason": "KernelModulesNotLoaded",
                        "status": "False",
                        "type": "KernelModulesLoaded"
                    },
                    "MountPropagation": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-06-04T10:16:12Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "MountPropagation"
                    },
                    "Multipathd": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-06-04T10:15:42Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "Multipathd"
                    },
                    "NFSClientInstalled": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-06-04T10:15:42Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "NFSClientInstalled"
                    },
                    "Ready": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-08-04T07:55:44Z",
                        "message": "Node worker-3 is ready",
                        "reason": "",
                        "status": "True",
                        "type": "Ready"
                    },
                    "RequiredPackages": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-06-04T10:15:42Z",
                        "message": "All required packages [nfs-common open-iscsi cryptsetup dmsetup] are installed",
                        "reason": "",
                        "status": "True",
                        "type": "RequiredPackages"
                    },
                    "Schedulable": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-07-29T07:53:19Z",
                        "message": "",
                        "reason": "",
                        "status": "True",
                        "type": "Schedulable"
                    }
                },
                "disks": {
                    "default-disk-5684ad78fcd5c40e": {
                        "allowScheduling": true,
                        "conditions": {
                            "Ready": {
                                "lastProbeTime": "",
                                "lastTransitionTime": "2025-06-04T10:16:12Z",
                                "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-3 is ready",
                                "reason": "",
                                "status": "True",
                                "type": "Ready"
                            },
                            "Schedulable": {
                                "lastProbeTime": "",
                                "lastTransitionTime": "2025-06-04T10:16:12Z",
                                "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-3 is schedulable",
                                "reason": "",
                                "status": "True",
                                "type": "Schedulable"
                            }
                        },
                        "diskDriver": "",
                        "diskType": "filesystem",
                        "diskUUID": "4c4d6347-5713-4c30-b15a-351fb0e39447",
                        "evictionRequested": false,
                        "path": "/var/lib/longhorn/",
                        "scheduledBackingImage": {},
                        "scheduledReplica": {
                            "pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-3f5b002c": 10485760000,
                            "pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-1633e160": 5242880000,
                            "pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-52128a9c": 10485760000,
                            "pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-d8156730": 10485760000,
                            "pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-07e0ec50": 5242880000,
                            "pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-75171f49": 5242880000,
                            "pvc-a587da80-2755-4911-987a-fd2756524a3e-r-f203ec8c": 4294967296,
                            "pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-548c7732": 2147483648,
                            "pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-c24a9a32": 5368709120,
                            "pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-8c80baaa": 10485760000
                        },
                        "storageAvailable": 47710208000,
                        "storageMaximum": 102888095744,
                        "storageReserved": 30866428723,
                        "storageScheduled": 69482840064,
                        "tags": []
                    }
                },
                "evictionRequested": false,
                "id": "worker-3",
                "instanceManagerCPURequest": 0,
                "links": {
                    "self": "http://172.17.17.155:32657/v1/nodes/worker-3"
                },
                "name": "worker-3",
                "region": "",
                "tags": [],
                "type": "node",
                "zone": ""
            }
        ],
        "links": {
            "self": "http://172.17.17.155:32657/v1/nodes"
        },
        "resourceType": "node",
        "type": "collection"
    },
    "msg": "OK (unknown bytes)",
    "redirected": false,
    "server": "nginx/1.21.5",
    "status": 200,
    "transfer_encoding": "chunked",
    "url": "http://172.17.17.155:32657/v1/nodes",
    "x_api_schemas": "http://172.17.17.155:32657/v1/schemas"
}

TASK [../roles/longhorn-storage-check : Check each node's storage] *************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/longhorn-storage-check/tasks/storage-availability.yaml:9
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.614211-25272-73661450802478 `" && echo ansible-tmp-1754538002.614211-25272-73661450802478="` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.614211-25272-73661450802478 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/command.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpgspr_quw TO /home/you/.ansible/tmp/ansible-tmp-1754538002.614211-25272-73661450802478/AnsiballZ_command.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538002.614211-25272-73661450802478/ /home/you/.ansible/tmp/ansible-tmp-1754538002.614211-25272-73661450802478/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538002.614211-25272-73661450802478/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538002.614211-25272-73661450802478/ > /dev/null 2>&1 && sleep 0'
ok: [localhost] => (item={'actions': {'diskUpdate': 'http://172.17.17.155:32657/v1/nodes/worker-1?action=diskUpdate'}, 'address': '192.168.226.97', 'allowScheduling': True, 'autoEvicting': False, 'conditions': {'KernelModulesLoaded': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:02Z', 'message': 'Kernel modules [dm_crypt] are not loaded', 'reason': 'KernelModulesNotLoaded', 'status': 'False', 'type': 'KernelModulesLoaded'}, 'MountPropagation': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:32Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'MountPropagation'}, 'Multipathd': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:02Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'Multipathd'}, 'NFSClientInstalled': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:02Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'NFSClientInstalled'}, 'Ready': {'lastProbeTime': '', 'lastTransitionTime': '2025-08-06T05:49:46Z', 'message': 'Node worker-1 is ready', 'reason': '', 'status': 'True', 'type': 'Ready'}, 'RequiredPackages': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:02Z', 'message': 'All required packages [dmsetup nfs-common open-iscsi cryptsetup] are installed', 'reason': '', 'status': 'True', 'type': 'RequiredPackages'}, 'Schedulable': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:02Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'Schedulable'}}, 'disks': {'default-disk-5684ad78fcd5c40e': {'allowScheduling': True, 'conditions': {'Ready': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:32Z', 'message': 'Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-1 is ready', 'reason': '', 'status': 'True', 'type': 'Ready'}, 'Schedulable': {'lastProbeTime': '', 'lastTransitionTime': '2025-08-04T07:56:11Z', 'message': 'Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-1 is schedulable', 'reason': '', 'status': 'True', 'type': 'Schedulable'}}, 'diskDriver': '', 'diskType': 'filesystem', 'diskUUID': 'b315176b-61a4-4bfa-9f75-ae8a2a530190', 'evictionRequested': False, 'path': '/var/lib/longhorn/', 'scheduledBackingImage': {}, 'scheduledReplica': {'pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-967908d0': 10485760000, 'pvc-25f58630-1871-4f98-8c61-029ecd3fc407-r-d7120810': 5242880000, 'pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-f39adbf4': 5242880000, 'pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-0af53656': 10485760000, 'pvc-46d0162b-eecf-476a-b23c-95c677ea50a7-r-2e40f1ad': 5242880000, 'pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-627adbe5': 10485760000, 'pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-b57514ee': 5242880000, 'pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-91c79a9b': 5242880000, 'pvc-a587da80-2755-4911-987a-fd2756524a3e-r-c6229f73': 4294967296, 'pvc-a637fc53-1a9a-489b-b415-a56dc48e1912-r-0b2fe2e5': 5242880000, 'pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-7b39913a': 2147483648, 'pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-2d273a33': 5368709120, 'pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-b0c0b372': 10485760000}, 'storageAvailable': 34812723200, 'storageMaximum': 123690532864, 'storageReserved': 30866428723, 'storageScheduled': 85211480064, 'tags': []}}, 'evictionRequested': False, 'id': 'worker-1', 'instanceManagerCPURequest': 0, 'links': {'self': 'http://172.17.17.155:32657/v1/nodes/worker-1'}, 'name': 'worker-1', 'region': '', 'tags': [], 'type': 'node', 'zone': ''}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "cmd": "node_name=\"worker-1\"\ntotal_max=0\ntotal_scheduled=0\n\n# Process each disk\ntotal_max=$((total_max + 123690532864))\ntotal_scheduled=$((total_scheduled + 85211480064))\n\n# Calculate percentage\nif [ $total_max -gt 0 ]; then\n  available_pct=$(echo \"scale=2; ($total_max - $total_scheduled) * 100 / $total_max\" | bc)\nelse\n  available_pct=0\nfi\n\necho \"Node $node_name: $available_pct% available\"\n\n# Check if sufficient\nif (( $(echo \"$available_pct < 25\" | bc -l) )); then\n  echo \"INSUFFICIENT: $node_name has $available_pct% available, need 25%\"\n  exit 1\nfi\n",
    "delta": "0:00:00.004630",
    "end": "2025-08-07 09:40:02.721108",
    "invocation": {
        "module_args": {
            "_raw_params": "node_name=\"worker-1\"\ntotal_max=0\ntotal_scheduled=0\n\n# Process each disk\ntotal_max=$((total_max + 123690532864))\ntotal_scheduled=$((total_scheduled + 85211480064))\n\n# Calculate percentage\nif [ $total_max -gt 0 ]; then\n  available_pct=$(echo \"scale=2; ($total_max - $total_scheduled) * 100 / $total_max\" | bc)\nelse\n  available_pct=0\nfi\n\necho \"Node $node_name: $available_pct% available\"\n\n# Check if sufficient\nif (( $(echo \"$available_pct < 25\" | bc -l) )); then\n  echo \"INSUFFICIENT: $node_name has $available_pct% available, need 25%\"\n  exit 1\nfi\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "item": {
        "actions": {
            "diskUpdate": "http://172.17.17.155:32657/v1/nodes/worker-1?action=diskUpdate"
        },
        "address": "192.168.226.97",
        "allowScheduling": true,
        "autoEvicting": false,
        "conditions": {
            "KernelModulesLoaded": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:02Z",
                "message": "Kernel modules [dm_crypt] are not loaded",
                "reason": "KernelModulesNotLoaded",
                "status": "False",
                "type": "KernelModulesLoaded"
            },
            "MountPropagation": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:32Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "MountPropagation"
            },
            "Multipathd": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:02Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "Multipathd"
            },
            "NFSClientInstalled": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:02Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "NFSClientInstalled"
            },
            "Ready": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-08-06T05:49:46Z",
                "message": "Node worker-1 is ready",
                "reason": "",
                "status": "True",
                "type": "Ready"
            },
            "RequiredPackages": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:02Z",
                "message": "All required packages [dmsetup nfs-common open-iscsi cryptsetup] are installed",
                "reason": "",
                "status": "True",
                "type": "RequiredPackages"
            },
            "Schedulable": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:02Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "Schedulable"
            }
        },
        "disks": {
            "default-disk-5684ad78fcd5c40e": {
                "allowScheduling": true,
                "conditions": {
                    "Ready": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:32Z",
                        "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-1 is ready",
                        "reason": "",
                        "status": "True",
                        "type": "Ready"
                    },
                    "Schedulable": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-08-04T07:56:11Z",
                        "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-1 is schedulable",
                        "reason": "",
                        "status": "True",
                        "type": "Schedulable"
                    }
                },
                "diskDriver": "",
                "diskType": "filesystem",
                "diskUUID": "b315176b-61a4-4bfa-9f75-ae8a2a530190",
                "evictionRequested": false,
                "path": "/var/lib/longhorn/",
                "scheduledBackingImage": {},
                "scheduledReplica": {
                    "pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-967908d0": 10485760000,
                    "pvc-25f58630-1871-4f98-8c61-029ecd3fc407-r-d7120810": 5242880000,
                    "pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-f39adbf4": 5242880000,
                    "pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-0af53656": 10485760000,
                    "pvc-46d0162b-eecf-476a-b23c-95c677ea50a7-r-2e40f1ad": 5242880000,
                    "pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-627adbe5": 10485760000,
                    "pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-b57514ee": 5242880000,
                    "pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-91c79a9b": 5242880000,
                    "pvc-a587da80-2755-4911-987a-fd2756524a3e-r-c6229f73": 4294967296,
                    "pvc-a637fc53-1a9a-489b-b415-a56dc48e1912-r-0b2fe2e5": 5242880000,
                    "pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-7b39913a": 2147483648,
                    "pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-2d273a33": 5368709120,
                    "pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-b0c0b372": 10485760000
                },
                "storageAvailable": 34812723200,
                "storageMaximum": 123690532864,
                "storageReserved": 30866428723,
                "storageScheduled": 85211480064,
                "tags": []
            }
        },
        "evictionRequested": false,
        "id": "worker-1",
        "instanceManagerCPURequest": 0,
        "links": {
            "self": "http://172.17.17.155:32657/v1/nodes/worker-1"
        },
        "name": "worker-1",
        "region": "",
        "tags": [],
        "type": "node",
        "zone": ""
    },
    "msg": "",
    "rc": 0,
    "start": "2025-08-07 09:40:02.716478",
    "stderr": "/bin/sh: 19: 0: not found",
    "stderr_lines": [
        "/bin/sh: 19: 0: not found"
    ],
    "stdout": "Node worker-1: 31.10% available",
    "stdout_lines": [
        "Node worker-1: 31.10% available"
    ]
}
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.7419522-25272-83284789202649 `" && echo ansible-tmp-1754538002.7419522-25272-83284789202649="` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.7419522-25272-83284789202649 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/command.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpbe5j5w5g TO /home/you/.ansible/tmp/ansible-tmp-1754538002.7419522-25272-83284789202649/AnsiballZ_command.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538002.7419522-25272-83284789202649/ /home/you/.ansible/tmp/ansible-tmp-1754538002.7419522-25272-83284789202649/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538002.7419522-25272-83284789202649/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538002.7419522-25272-83284789202649/ > /dev/null 2>&1 && sleep 0'
ok: [localhost] => (item={'actions': {'diskUpdate': 'http://172.17.17.155:32657/v1/nodes/worker-2?action=diskUpdate'}, 'address': '192.168.133.250', 'allowScheduling': True, 'autoEvicting': False, 'conditions': {'KernelModulesLoaded': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:09Z', 'message': 'Kernel modules [dm_crypt] are not loaded', 'reason': 'KernelModulesNotLoaded', 'status': 'False', 'type': 'KernelModulesLoaded'}, 'MountPropagation': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:39Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'MountPropagation'}, 'Multipathd': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:09Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'Multipathd'}, 'NFSClientInstalled': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:09Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'NFSClientInstalled'}, 'Ready': {'lastProbeTime': '', 'lastTransitionTime': '2025-08-06T05:49:58Z', 'message': 'Node worker-2 is ready', 'reason': '', 'status': 'True', 'type': 'Ready'}, 'RequiredPackages': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:09Z', 'message': 'All required packages [open-iscsi cryptsetup dmsetup nfs-common] are installed', 'reason': '', 'status': 'True', 'type': 'RequiredPackages'}, 'Schedulable': {'lastProbeTime': '', 'lastTransitionTime': '2025-08-04T06:21:32Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'Schedulable'}}, 'disks': {'default-disk-5684ad78fcd5c40e': {'allowScheduling': True, 'conditions': {'Ready': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:39Z', 'message': 'Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-2 is ready', 'reason': '', 'status': 'True', 'type': 'Ready'}, 'Schedulable': {'lastProbeTime': '', 'lastTransitionTime': '2025-04-22T06:31:39Z', 'message': 'Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-2 is schedulable', 'reason': '', 'status': 'True', 'type': 'Schedulable'}}, 'diskDriver': '', 'diskType': 'filesystem', 'diskUUID': 'b2f6d917-8fb4-4ddf-bf82-eb5ecce3f60b', 'evictionRequested': False, 'path': '/var/lib/longhorn/', 'scheduledBackingImage': {}, 'scheduledReplica': {'pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-165198ea': 10485760000, 'pvc-25f58630-1871-4f98-8c61-029ecd3fc407-r-14f9a78e': 5242880000, 'pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-3a880fce': 5242880000, 'pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-7e356162': 10485760000, 'pvc-46d0162b-eecf-476a-b23c-95c677ea50a7-r-1a157f2a': 5242880000, 'pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-eae499eb': 10485760000, 'pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-de2a8360': 5242880000, 'pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-052d1765': 5242880000, 'pvc-a587da80-2755-4911-987a-fd2756524a3e-r-c3bf121a': 4294967296, 'pvc-a637fc53-1a9a-489b-b415-a56dc48e1912-r-5d5f0117': 5242880000, 'pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-45587f2a': 2147483648, 'pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-07451069': 5368709120, 'pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-82d4ca34': 10485760000}, 'storageAvailable': 59873689600, 'storageMaximum': 123690532864, 'storageReserved': 30866428723, 'storageScheduled': 85211480064, 'tags': []}}, 'evictionRequested': False, 'id': 'worker-2', 'instanceManagerCPURequest': 0, 'links': {'self': 'http://172.17.17.155:32657/v1/nodes/worker-2'}, 'name': 'worker-2', 'region': '', 'tags': [], 'type': 'node', 'zone': ''}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "cmd": "node_name=\"worker-2\"\ntotal_max=0\ntotal_scheduled=0\n\n# Process each disk\ntotal_max=$((total_max + 123690532864))\ntotal_scheduled=$((total_scheduled + 85211480064))\n\n# Calculate percentage\nif [ $total_max -gt 0 ]; then\n  available_pct=$(echo \"scale=2; ($total_max - $total_scheduled) * 100 / $total_max\" | bc)\nelse\n  available_pct=0\nfi\n\necho \"Node $node_name: $available_pct% available\"\n\n# Check if sufficient\nif (( $(echo \"$available_pct < 25\" | bc -l) )); then\n  echo \"INSUFFICIENT: $node_name has $available_pct% available, need 25%\"\n  exit 1\nfi\n",
    "delta": "0:00:00.004365",
    "end": "2025-08-07 09:40:02.847929",
    "invocation": {
        "module_args": {
            "_raw_params": "node_name=\"worker-2\"\ntotal_max=0\ntotal_scheduled=0\n\n# Process each disk\ntotal_max=$((total_max + 123690532864))\ntotal_scheduled=$((total_scheduled + 85211480064))\n\n# Calculate percentage\nif [ $total_max -gt 0 ]; then\n  available_pct=$(echo \"scale=2; ($total_max - $total_scheduled) * 100 / $total_max\" | bc)\nelse\n  available_pct=0\nfi\n\necho \"Node $node_name: $available_pct% available\"\n\n# Check if sufficient\nif (( $(echo \"$available_pct < 25\" | bc -l) )); then\n  echo \"INSUFFICIENT: $node_name has $available_pct% available, need 25%\"\n  exit 1\nfi\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "item": {
        "actions": {
            "diskUpdate": "http://172.17.17.155:32657/v1/nodes/worker-2?action=diskUpdate"
        },
        "address": "192.168.133.250",
        "allowScheduling": true,
        "autoEvicting": false,
        "conditions": {
            "KernelModulesLoaded": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:09Z",
                "message": "Kernel modules [dm_crypt] are not loaded",
                "reason": "KernelModulesNotLoaded",
                "status": "False",
                "type": "KernelModulesLoaded"
            },
            "MountPropagation": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:39Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "MountPropagation"
            },
            "Multipathd": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:09Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "Multipathd"
            },
            "NFSClientInstalled": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:09Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "NFSClientInstalled"
            },
            "Ready": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-08-06T05:49:58Z",
                "message": "Node worker-2 is ready",
                "reason": "",
                "status": "True",
                "type": "Ready"
            },
            "RequiredPackages": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-04-22T06:31:09Z",
                "message": "All required packages [open-iscsi cryptsetup dmsetup nfs-common] are installed",
                "reason": "",
                "status": "True",
                "type": "RequiredPackages"
            },
            "Schedulable": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-08-04T06:21:32Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "Schedulable"
            }
        },
        "disks": {
            "default-disk-5684ad78fcd5c40e": {
                "allowScheduling": true,
                "conditions": {
                    "Ready": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:39Z",
                        "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-2 is ready",
                        "reason": "",
                        "status": "True",
                        "type": "Ready"
                    },
                    "Schedulable": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-04-22T06:31:39Z",
                        "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-2 is schedulable",
                        "reason": "",
                        "status": "True",
                        "type": "Schedulable"
                    }
                },
                "diskDriver": "",
                "diskType": "filesystem",
                "diskUUID": "b2f6d917-8fb4-4ddf-bf82-eb5ecce3f60b",
                "evictionRequested": false,
                "path": "/var/lib/longhorn/",
                "scheduledBackingImage": {},
                "scheduledReplica": {
                    "pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-165198ea": 10485760000,
                    "pvc-25f58630-1871-4f98-8c61-029ecd3fc407-r-14f9a78e": 5242880000,
                    "pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-3a880fce": 5242880000,
                    "pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-7e356162": 10485760000,
                    "pvc-46d0162b-eecf-476a-b23c-95c677ea50a7-r-1a157f2a": 5242880000,
                    "pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-eae499eb": 10485760000,
                    "pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-de2a8360": 5242880000,
                    "pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-052d1765": 5242880000,
                    "pvc-a587da80-2755-4911-987a-fd2756524a3e-r-c3bf121a": 4294967296,
                    "pvc-a637fc53-1a9a-489b-b415-a56dc48e1912-r-5d5f0117": 5242880000,
                    "pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-45587f2a": 2147483648,
                    "pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-07451069": 5368709120,
                    "pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-82d4ca34": 10485760000
                },
                "storageAvailable": 59873689600,
                "storageMaximum": 123690532864,
                "storageReserved": 30866428723,
                "storageScheduled": 85211480064,
                "tags": []
            }
        },
        "evictionRequested": false,
        "id": "worker-2",
        "instanceManagerCPURequest": 0,
        "links": {
            "self": "http://172.17.17.155:32657/v1/nodes/worker-2"
        },
        "name": "worker-2",
        "region": "",
        "tags": [],
        "type": "node",
        "zone": ""
    },
    "msg": "",
    "rc": 0,
    "start": "2025-08-07 09:40:02.843564",
    "stderr": "/bin/sh: 19: 0: not found",
    "stderr_lines": [
        "/bin/sh: 19: 0: not found"
    ],
    "stdout": "Node worker-2: 31.10% available",
    "stdout_lines": [
        "Node worker-2: 31.10% available"
    ]
}
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.8683374-25272-69776518759446 `" && echo ansible-tmp-1754538002.8683374-25272-69776518759446="` echo /home/you/.ansible/tmp/ansible-tmp-1754538002.8683374-25272-69776518759446 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/command.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmp5cxs4e4p TO /home/you/.ansible/tmp/ansible-tmp-1754538002.8683374-25272-69776518759446/AnsiballZ_command.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538002.8683374-25272-69776518759446/ /home/you/.ansible/tmp/ansible-tmp-1754538002.8683374-25272-69776518759446/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538002.8683374-25272-69776518759446/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538002.8683374-25272-69776518759446/ > /dev/null 2>&1 && sleep 0'
ok: [localhost] => (item={'actions': {'diskUpdate': 'http://172.17.17.155:32657/v1/nodes/worker-3?action=diskUpdate'}, 'address': '192.168.97.232', 'allowScheduling': True, 'autoEvicting': False, 'conditions': {'KernelModulesLoaded': {'lastProbeTime': '', 'lastTransitionTime': '2025-06-04T10:15:42Z', 'message': 'Kernel modules [dm_crypt] are not loaded', 'reason': 'KernelModulesNotLoaded', 'status': 'False', 'type': 'KernelModulesLoaded'}, 'MountPropagation': {'lastProbeTime': '', 'lastTransitionTime': '2025-06-04T10:16:12Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'MountPropagation'}, 'Multipathd': {'lastProbeTime': '', 'lastTransitionTime': '2025-06-04T10:15:42Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'Multipathd'}, 'NFSClientInstalled': {'lastProbeTime': '', 'lastTransitionTime': '2025-06-04T10:15:42Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'NFSClientInstalled'}, 'Ready': {'lastProbeTime': '', 'lastTransitionTime': '2025-08-04T07:55:44Z', 'message': 'Node worker-3 is ready', 'reason': '', 'status': 'True', 'type': 'Ready'}, 'RequiredPackages': {'lastProbeTime': '', 'lastTransitionTime': '2025-06-04T10:15:42Z', 'message': 'All required packages [nfs-common open-iscsi cryptsetup dmsetup] are installed', 'reason': '', 'status': 'True', 'type': 'RequiredPackages'}, 'Schedulable': {'lastProbeTime': '', 'lastTransitionTime': '2025-07-29T07:53:19Z', 'message': '', 'reason': '', 'status': 'True', 'type': 'Schedulable'}}, 'disks': {'default-disk-5684ad78fcd5c40e': {'allowScheduling': True, 'conditions': {'Ready': {'lastProbeTime': '', 'lastTransitionTime': '2025-06-04T10:16:12Z', 'message': 'Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-3 is ready', 'reason': '', 'status': 'True', 'type': 'Ready'}, 'Schedulable': {'lastProbeTime': '', 'lastTransitionTime': '2025-06-04T10:16:12Z', 'message': 'Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-3 is schedulable', 'reason': '', 'status': 'True', 'type': 'Schedulable'}}, 'diskDriver': '', 'diskType': 'filesystem', 'diskUUID': '4c4d6347-5713-4c30-b15a-351fb0e39447', 'evictionRequested': False, 'path': '/var/lib/longhorn/', 'scheduledBackingImage': {}, 'scheduledReplica': {'pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-3f5b002c': 10485760000, 'pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-1633e160': 5242880000, 'pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-52128a9c': 10485760000, 'pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-d8156730': 10485760000, 'pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-07e0ec50': 5242880000, 'pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-75171f49': 5242880000, 'pvc-a587da80-2755-4911-987a-fd2756524a3e-r-f203ec8c': 4294967296, 'pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-548c7732': 2147483648, 'pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-c24a9a32': 5368709120, 'pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-8c80baaa': 10485760000}, 'storageAvailable': 47710208000, 'storageMaximum': 102888095744, 'storageReserved': 30866428723, 'storageScheduled': 69482840064, 'tags': []}}, 'evictionRequested': False, 'id': 'worker-3', 'instanceManagerCPURequest': 0, 'links': {'self': 'http://172.17.17.155:32657/v1/nodes/worker-3'}, 'name': 'worker-3', 'region': '', 'tags': [], 'type': 'node', 'zone': ''}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "cmd": "node_name=\"worker-3\"\ntotal_max=0\ntotal_scheduled=0\n\n# Process each disk\ntotal_max=$((total_max + 102888095744))\ntotal_scheduled=$((total_scheduled + 69482840064))\n\n# Calculate percentage\nif [ $total_max -gt 0 ]; then\n  available_pct=$(echo \"scale=2; ($total_max - $total_scheduled) * 100 / $total_max\" | bc)\nelse\n  available_pct=0\nfi\n\necho \"Node $node_name: $available_pct% available\"\n\n# Check if sufficient\nif (( $(echo \"$available_pct < 25\" | bc -l) )); then\n  echo \"INSUFFICIENT: $node_name has $available_pct% available, need 25%\"\n  exit 1\nfi\n",
    "delta": "0:00:00.004465",
    "end": "2025-08-07 09:40:02.973895",
    "invocation": {
        "module_args": {
            "_raw_params": "node_name=\"worker-3\"\ntotal_max=0\ntotal_scheduled=0\n\n# Process each disk\ntotal_max=$((total_max + 102888095744))\ntotal_scheduled=$((total_scheduled + 69482840064))\n\n# Calculate percentage\nif [ $total_max -gt 0 ]; then\n  available_pct=$(echo \"scale=2; ($total_max - $total_scheduled) * 100 / $total_max\" | bc)\nelse\n  available_pct=0\nfi\n\necho \"Node $node_name: $available_pct% available\"\n\n# Check if sufficient\nif (( $(echo \"$available_pct < 25\" | bc -l) )); then\n  echo \"INSUFFICIENT: $node_name has $available_pct% available, need 25%\"\n  exit 1\nfi\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "item": {
        "actions": {
            "diskUpdate": "http://172.17.17.155:32657/v1/nodes/worker-3?action=diskUpdate"
        },
        "address": "192.168.97.232",
        "allowScheduling": true,
        "autoEvicting": false,
        "conditions": {
            "KernelModulesLoaded": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-06-04T10:15:42Z",
                "message": "Kernel modules [dm_crypt] are not loaded",
                "reason": "KernelModulesNotLoaded",
                "status": "False",
                "type": "KernelModulesLoaded"
            },
            "MountPropagation": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-06-04T10:16:12Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "MountPropagation"
            },
            "Multipathd": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-06-04T10:15:42Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "Multipathd"
            },
            "NFSClientInstalled": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-06-04T10:15:42Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "NFSClientInstalled"
            },
            "Ready": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-08-04T07:55:44Z",
                "message": "Node worker-3 is ready",
                "reason": "",
                "status": "True",
                "type": "Ready"
            },
            "RequiredPackages": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-06-04T10:15:42Z",
                "message": "All required packages [nfs-common open-iscsi cryptsetup dmsetup] are installed",
                "reason": "",
                "status": "True",
                "type": "RequiredPackages"
            },
            "Schedulable": {
                "lastProbeTime": "",
                "lastTransitionTime": "2025-07-29T07:53:19Z",
                "message": "",
                "reason": "",
                "status": "True",
                "type": "Schedulable"
            }
        },
        "disks": {
            "default-disk-5684ad78fcd5c40e": {
                "allowScheduling": true,
                "conditions": {
                    "Ready": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-06-04T10:16:12Z",
                        "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-3 is ready",
                        "reason": "",
                        "status": "True",
                        "type": "Ready"
                    },
                    "Schedulable": {
                        "lastProbeTime": "",
                        "lastTransitionTime": "2025-06-04T10:16:12Z",
                        "message": "Disk default-disk-5684ad78fcd5c40e(/var/lib/longhorn/) on node worker-3 is schedulable",
                        "reason": "",
                        "status": "True",
                        "type": "Schedulable"
                    }
                },
                "diskDriver": "",
                "diskType": "filesystem",
                "diskUUID": "4c4d6347-5713-4c30-b15a-351fb0e39447",
                "evictionRequested": false,
                "path": "/var/lib/longhorn/",
                "scheduledBackingImage": {},
                "scheduledReplica": {
                    "pvc-0d33af98-d313-4869-856c-73ec695e5bcf-r-3f5b002c": 10485760000,
                    "pvc-2addde90-9d9e-4b24-bf7f-2fc36dbdb816-r-1633e160": 5242880000,
                    "pvc-3b63ea59-916a-47fa-a03d-e8823635069b-r-52128a9c": 10485760000,
                    "pvc-4deea13c-e26b-41fb-aeff-f60c91456cb4-r-d8156730": 10485760000,
                    "pvc-548ac745-0681-4e22-a9f6-766e51efe150-r-07e0ec50": 5242880000,
                    "pvc-8dd7383b-986b-4416-bd16-0691dc4154bd-r-75171f49": 5242880000,
                    "pvc-a587da80-2755-4911-987a-fd2756524a3e-r-f203ec8c": 4294967296,
                    "pvc-a7c6b5db-1f44-44f6-a648-e00eca1192e3-r-548c7732": 2147483648,
                    "pvc-baceed71-bce8-4684-b80b-fa985fc4f4ab-r-c24a9a32": 5368709120,
                    "pvc-c6b1caa9-131b-45d2-af03-9bfc92289ced-r-8c80baaa": 10485760000
                },
                "storageAvailable": 47710208000,
                "storageMaximum": 102888095744,
                "storageReserved": 30866428723,
                "storageScheduled": 69482840064,
                "tags": []
            }
        },
        "evictionRequested": false,
        "id": "worker-3",
        "instanceManagerCPURequest": 0,
        "links": {
            "self": "http://172.17.17.155:32657/v1/nodes/worker-3"
        },
        "name": "worker-3",
        "region": "",
        "tags": [],
        "type": "node",
        "zone": ""
    },
    "msg": "",
    "rc": 0,
    "start": "2025-08-07 09:40:02.969430",
    "stderr": "/bin/sh: 19: 0: not found",
    "stderr_lines": [
        "/bin/sh: 19: 0: not found"
    ],
    "stdout": "Node worker-3: 32.46% available",
    "stdout_lines": [
        "Node worker-3: 32.46% available"
    ]
}

TASK [include_tasks] ***********************************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:100
included: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/restore-db.yaml for localhost

TASK [Restore PostgreSQL dump into target database] ****************************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/postgres/tasks/restore-db.yaml:1
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538003.0227263-25373-169867371007207 `" && echo ansible-tmp-1754538003.0227263-25373-169867371007207="` echo /home/you/.ansible/tmp/ansible-tmp-1754538003.0227263-25373-169867371007207 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/command.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpqylvtd6f TO /home/you/.ansible/tmp/ansible-tmp-1754538003.0227263-25373-169867371007207/AnsiballZ_command.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538003.0227263-25373-169867371007207/ /home/you/.ansible/tmp/ansible-tmp-1754538003.0227263-25373-169867371007207/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538003.0227263-25373-169867371007207/AnsiballZ_command.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538003.0227263-25373-169867371007207/ > /dev/null 2>&1 && sleep 0'
fatal: [localhost]: FAILED! => {
    "changed": true,
    "cmd": "PGPASSWORD='superAdmin' pg_restore  -h 172.17.17.163 -p 5432  -U rootuser -d corteza    \"../dumps/corteza_from_172.17.17.160.dump\"\n",
    "delta": "0:01:32.429118",
    "end": "2025-08-07 09:41:35.560241",
    "invocation": {
        "module_args": {
            "_raw_params": "PGPASSWORD='superAdmin' pg_restore  -h 172.17.17.163 -p 5432  -U rootuser -d corteza    \"../dumps/corteza_from_172.17.17.160.dump\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 1,
    "start": "2025-08-07 09:40:03.131123",
    "stderr": "pg_restore: error: could not execute query: ERROR:  unrecognized configuration parameter \"transaction_timeout\"\nCommand was: SET transaction_timeout = 0;\npg_restore: error: could not execute query: ERROR:  schema \"metric_helpers\" already exists\nCommand was: CREATE SCHEMA metric_helpers;\n\n\npg_restore: error: could not execute query: ERROR:  schema \"user_management\" already exists\nCommand was: CREATE SCHEMA user_management;\n\n\npg_restore: error: could not execute query: ERROR:  function \"get_btree_bloat_approx\" already exists with same argument types\nCommand was: CREATE FUNCTION metric_helpers.get_btree_bloat_approx(OUT i_database name, OUT i_schema_name name, OUT i_table_name name, OUT i_index_name name, OUT i_real_size numeric, OUT i_extra_size numeric, OUT i_extra_ratio double precision, OUT i_fill_factor integer, OUT i_bloat_size double precision, OUT i_bloat_ratio double precision, OUT i_is_na boolean) RETURNS SETOF record\n    LANGUAGE sql IMMUTABLE STRICT SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $$\nSELECT current_database(), nspname AS schemaname, tblname, idxname, bs*(relpages)::bigint AS real_size,\n  bs*(relpages-est_pages)::bigint AS extra_size,\n  100 * (relpages-est_pages)::float / relpages AS extra_ratio,\n  fillfactor,\n  CASE WHEN relpages > est_pages_ff\n    THEN bs*(relpages-est_pages_ff)\n    ELSE 0\n  END AS bloat_size,\n  100 * (relpages-est_pages_ff)::float / relpages AS bloat_ratio,\n  is_na\n  -- , 100-(pst).avg_leaf_density AS pst_avg_bloat, est_pages, index_tuple_hdr_bm, maxalign, pagehdr, nulldatawidth, nulldatahdrwidth, reltuples, relpages -- (DEBUG INFO)\nFROM (\n  SELECT coalesce(1 +\n         ceil(reltuples/floor((bs-pageopqdata-pagehdr)/(4+nulldatahdrwidth)::float)), 0 -- ItemIdData size + computed avg size of a tuple (nulldatahdrwidth)\n      ) AS est_pages,\n      coalesce(1 +\n         ceil(reltuples/floor((bs-pageopqdata-pagehdr)*fillfactor/(100*(4+nulldatahdrwidth)::float))), 0\n      ) AS est_pages_ff,\n      bs, nspname, tblname, idxname, relpages, fillfactor, is_na\n      -- , pgstatindex(idxoid) AS pst, index_tuple_hdr_bm, maxalign, pagehdr, nulldatawidth, nulldatahdrwidth, reltuples -- (DEBUG INFO)\n  FROM (\n      SELECT maxalign, bs, nspname, tblname, idxname, reltuples, relpages, idxoid, fillfactor,\n            ( index_tuple_hdr_bm +\n                maxalign - CASE -- Add padding to the index tuple header to align on MAXALIGN\n                  WHEN index_tuple_hdr_bm%maxalign = 0 THEN maxalign\n                  ELSE index_tuple_hdr_bm%maxalign\n                END\n              + nulldatawidth + maxalign - CASE -- Add padding to the data to align on MAXALIGN\n                  WHEN nulldatawidth = 0 THEN 0\n                  WHEN nulldatawidth::integer%maxalign = 0 THEN maxalign\n                  ELSE nulldatawidth::integer%maxalign\n                END\n            )::numeric AS nulldatahdrwidth, pagehdr, pageopqdata, is_na\n            -- , index_tuple_hdr_bm, nulldatawidth -- (DEBUG INFO)\n      FROM (\n          SELECT n.nspname, ct.relname AS tblname, i.idxname, i.reltuples, i.relpages,\n              i.idxoid, i.fillfactor, current_setting('block_size')::numeric AS bs,\n              CASE -- MAXALIGN: 4 on 32bits, 8 on 64bits (and mingw32 ?)\n                WHEN version() ~ 'mingw32' OR version() ~ '64-bit|x86_64|ppc64|ia64|amd64' THEN 8\n                ELSE 4\n              END AS maxalign,\n              /* per page header, fixed size: 20 for 7.X, 24 for others */\n              24 AS pagehdr,\n              /* per page btree opaque data */\n              16 AS pageopqdata,\n              /* per tuple header: add IndexAttributeBitMapData if some cols are null-able */\n              CASE WHEN max(coalesce(s.stanullfrac,0)) = 0\n                  THEN 2 -- IndexTupleData size\n                  ELSE 2 + (( 32 + 8 - 1 ) / 8) -- IndexTupleData size + IndexAttributeBitMapData size ( max num filed per index + 8 - 1 /8)\n              END AS index_tuple_hdr_bm,\n              /* data len: we remove null values save space using it fractionnal part from stats */\n              sum( (1-coalesce(s.stanullfrac, 0)) * coalesce(s.stawidth, 1024)) AS nulldatawidth,\n              max( CASE WHEN a.atttypid = 'pg_catalog.name'::regtype THEN 1 ELSE 0 END ) > 0 AS is_na\n          FROM (\n              SELECT idxname, reltuples, relpages, tbloid, idxoid, fillfactor,\n                  CASE WHEN indkey[i]=0 THEN idxoid ELSE tbloid END AS att_rel,\n                  CASE WHEN indkey[i]=0 THEN i ELSE indkey[i] END AS att_pos\n              FROM (\n                  SELECT idxname, reltuples, relpages, tbloid, idxoid, fillfactor, indkey, generate_series(1,indnatts) AS i\n                  FROM (\n                      SELECT ci.relname AS idxname, ci.reltuples, ci.relpages, i.indrelid AS tbloid,\n                          i.indexrelid AS idxoid,\n                          coalesce(substring(\n                              array_to_string(ci.reloptions, ' ')\n                              from 'fillfactor=([0-9]+)')::smallint, 90) AS fillfactor,\n                          i.indnatts,\n                          string_to_array(textin(int2vectorout(i.indkey)),' ')::int[] AS indkey\n                      FROM pg_index i\n                      JOIN pg_class ci ON ci.oid=i.indexrelid\n                      WHERE ci.relam=(SELECT oid FROM pg_am WHERE amname = 'btree')\n                        AND ci.relpages > 0\n                  ) AS idx_data\n              ) AS idx_data_cross\n          ) i\n          JOIN pg_attribute a ON a.attrelid = i.att_rel\n                             AND a.attnum = i.att_pos\n          JOIN pg_statistic s ON s.starelid = i.att_rel\n                             AND s.staattnum = i.att_pos\n          JOIN pg_class ct ON ct.oid = i.tbloid\n          JOIN pg_namespace n ON ct.relnamespace = n.oid\n          GROUP BY 1,2,3,4,5,6,7,8,9,10\n      ) AS rows_data_stats\n  ) AS rows_hdr_pdg_stats\n) AS relation_stats;\n$$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"get_table_bloat_approx\" already exists with same argument types\nCommand was: CREATE FUNCTION metric_helpers.get_table_bloat_approx(OUT t_database name, OUT t_schema_name name, OUT t_table_name name, OUT t_real_size numeric, OUT t_extra_size double precision, OUT t_extra_ratio double precision, OUT t_fill_factor integer, OUT t_bloat_size double precision, OUT t_bloat_ratio double precision, OUT t_is_na boolean) RETURNS SETOF record\n    LANGUAGE sql IMMUTABLE STRICT SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $$\nSELECT\n  current_database(),\n  schemaname,\n  tblname,\n  (bs*tblpages) AS real_size,\n  ((tblpages-est_tblpages)*bs) AS extra_size,\n  CASE WHEN tblpages - est_tblpages > 0\n    THEN 100 * (tblpages - est_tblpages)/tblpages::float\n    ELSE 0\n  END AS extra_ratio,\n  fillfactor,\n  CASE WHEN tblpages - est_tblpages_ff > 0\n    THEN (tblpages-est_tblpages_ff)*bs\n    ELSE 0\n  END AS bloat_size,\n  CASE WHEN tblpages - est_tblpages_ff > 0\n    THEN 100 * (tblpages - est_tblpages_ff)/tblpages::float\n    ELSE 0\n  END AS bloat_ratio,\n  is_na\nFROM (\n  SELECT ceil( reltuples / ( (bs-page_hdr)/tpl_size ) ) + ceil( toasttuples / 4 ) AS est_tblpages,\n    ceil( reltuples / ( (bs-page_hdr)*fillfactor/(tpl_size*100) ) ) + ceil( toasttuples / 4 ) AS est_tblpages_ff,\n    tblpages, fillfactor, bs, tblid, schemaname, tblname, heappages, toastpages, is_na\n    -- , tpl_hdr_size, tpl_data_size, pgstattuple(tblid) AS pst -- (DEBUG INFO)\n  FROM (\n    SELECT\n      ( 4 + tpl_hdr_size + tpl_data_size + (2*ma)\n        - CASE WHEN tpl_hdr_size%ma = 0 THEN ma ELSE tpl_hdr_size%ma END\n        - CASE WHEN ceil(tpl_data_size)::int%ma = 0 THEN ma ELSE ceil(tpl_data_size)::int%ma END\n      ) AS tpl_size, bs - page_hdr AS size_per_block, (heappages + toastpages) AS tblpages, heappages,\n      toastpages, reltuples, toasttuples, bs, page_hdr, tblid, schemaname, tblname, fillfactor, is_na\n      -- , tpl_hdr_size, tpl_data_size\n    FROM (\n      SELECT\n        tbl.oid AS tblid, ns.nspname AS schemaname, tbl.relname AS tblname, tbl.reltuples,\n        tbl.relpages AS heappages, coalesce(toast.relpages, 0) AS toastpages,\n        coalesce(toast.reltuples, 0) AS toasttuples,\n        coalesce(substring(\n          array_to_string(tbl.reloptions, ' ')\n          FROM 'fillfactor=([0-9]+)')::smallint, 100) AS fillfactor,\n        current_setting('block_size')::numeric AS bs,\n        CASE WHEN version()~'mingw32' OR version()~'64-bit|x86_64|ppc64|ia64|amd64' THEN 8 ELSE 4 END AS ma,\n        24 AS page_hdr,\n        23 + CASE WHEN MAX(coalesce(s.null_frac,0)) > 0 THEN ( 7 + count(s.attname) ) / 8 ELSE 0::int END\n           + CASE WHEN bool_or(att.attname = 'oid' and att.attnum < 0) THEN 4 ELSE 0 END AS tpl_hdr_size,\n        sum( (1-coalesce(s.null_frac, 0)) * coalesce(s.avg_width, 0) ) AS tpl_data_size,\n        bool_or(att.atttypid = 'pg_catalog.name'::regtype)\n          OR sum(CASE WHEN att.attnum > 0 THEN 1 ELSE 0 END) <> count(s.attname) AS is_na\n      FROM pg_attribute AS att\n        JOIN pg_class AS tbl ON att.attrelid = tbl.oid\n        JOIN pg_namespace AS ns ON ns.oid = tbl.relnamespace\n        LEFT JOIN pg_stats AS s ON s.schemaname=ns.nspname\n          AND s.tablename = tbl.relname AND s.inherited=false AND s.attname=att.attname\n        LEFT JOIN pg_class AS toast ON tbl.reltoastrelid = toast.oid\n      WHERE NOT att.attisdropped\n        AND tbl.relkind = 'r'\n      GROUP BY 1,2,3,4,5,6,7,8,9,10\n      ORDER BY 2,3\n    ) AS s\n  ) AS s2\n) AS s3 WHERE schemaname NOT LIKE 'information_schema';\n$$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"pg_stat_statements\" already exists with same argument types\nCommand was: CREATE FUNCTION metric_helpers.pg_stat_statements(showtext boolean) RETURNS SETOF public.pg_stat_statements\n    LANGUAGE sql IMMUTABLE STRICT SECURITY DEFINER\n    AS $$\n  SELECT * FROM public.pg_stat_statements(showtext);\n$$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"create_application_user\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.create_application_user(username text) RETURNS text\n    LANGUAGE plpgsql SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $_$\nDECLARE\n    pw text;\nBEGIN\n    SELECT user_management.random_password(20) INTO pw;\n    EXECUTE format($$ CREATE USER %I WITH PASSWORD %L $$, username, pw);\n    RETURN pw;\nEND\n$_$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"create_application_user_or_change_password\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.create_application_user_or_change_password(username text, password text) RETURNS void\n    LANGUAGE plpgsql SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $_$\nBEGIN\n    PERFORM 1 FROM pg_roles WHERE rolname = username;\n\n    IF FOUND\n    THEN\n        EXECUTE format($$ ALTER ROLE %I WITH PASSWORD %L $$, username, password);\n    ELSE\n        EXECUTE format($$ CREATE USER %I WITH PASSWORD %L $$, username, password);\n    END IF;\nEND\n$_$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"create_role\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.create_role(rolename text) RETURNS void\n    LANGUAGE plpgsql SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $_$\nBEGIN\n    -- set ADMIN to the admin user, so every member of admin can GRANT these roles to each other\n    EXECUTE format($$ CREATE ROLE %I WITH ADMIN admin $$, rolename);\nEND;\n$_$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"create_user\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.create_user(username text) RETURNS void\n    LANGUAGE plpgsql SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $_$\nBEGIN\n    EXECUTE format($$ CREATE USER %I IN ROLE zalandos, admin $$, username);\n    EXECUTE format($$ ALTER ROLE %I SET log_statement TO 'all' $$, username);\nEND;\n$_$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"drop_role\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.drop_role(username text) RETURNS void\n    LANGUAGE sql SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $$\nSELECT user_management.drop_user(username);\n$$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"drop_user\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.drop_user(username text) RETURNS void\n    LANGUAGE plpgsql SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $_$\nBEGIN\n    EXECUTE format($$ DROP ROLE %I $$, username);\nEND\n$_$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"random_password\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.random_password(length integer) RETURNS text\n    LANGUAGE sql\n    SET search_path TO 'pg_catalog'\n    AS $$\nWITH chars (c) AS (\n    SELECT chr(33)\n    UNION ALL\n    SELECT chr(i) FROM generate_series (35, 38) AS t (i)\n    UNION ALL\n    SELECT chr(i) FROM generate_series (42, 90) AS t (i)\n    UNION ALL\n    SELECT chr(i) FROM generate_series (97, 122) AS t (i)\n),\nbricks (b) AS (\n    -- build a pool of chars (the size will be the number of chars above times length)\n    -- and shuffle it\n    SELECT c FROM chars, generate_series(1, length) ORDER BY random()\n)\nSELECT substr(string_agg(b, ''), 1, length) FROM bricks;\n$$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"revoke_admin\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.revoke_admin(username text) RETURNS void\n    LANGUAGE plpgsql SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $_$\nBEGIN\n    EXECUTE format($$ REVOKE admin FROM %I $$, username);\nEND\n$_$;\n\n\npg_restore: error: could not execute query: ERROR:  function \"terminate_backend\" already exists with same argument types\nCommand was: CREATE FUNCTION user_management.terminate_backend(pid integer) RETURNS boolean\n    LANGUAGE sql SECURITY DEFINER\n    SET search_path TO 'pg_catalog'\n    AS $$\nSELECT pg_terminate_backend(pid);\n$$;\n\n\npg_restore: error: could not execute query: ERROR:  relation \"index_bloat\" already exists\nCommand was: CREATE VIEW metric_helpers.index_bloat AS\n SELECT get_btree_bloat_approx.i_database,\n    get_btree_bloat_approx.i_schema_name,\n    get_btree_bloat_approx.i_table_name,\n    get_btree_bloat_approx.i_index_name,\n    get_btree_bloat_approx.i_real_size,\n    get_btree_bloat_approx.i_extra_size,\n    get_btree_bloat_approx.i_extra_ratio,\n    get_btree_bloat_approx.i_fill_factor,\n    get_btree_bloat_approx.i_bloat_size,\n    get_btree_bloat_approx.i_bloat_ratio,\n    get_btree_bloat_approx.i_is_na\n   FROM metric_helpers.get_btree_bloat_approx() get_btree_bloat_approx(i_database, i_schema_name, i_table_name, i_index_name, i_real_size, i_extra_size, i_extra_ratio, i_fill_factor, i_bloat_size, i_bloat_ratio, i_is_na);\n\n\npg_restore: error: could not execute query: ERROR:  relation \"pg_stat_statements\" already exists\nCommand was: CREATE VIEW metric_helpers.pg_stat_statements AS\n SELECT pg_stat_statements.userid,\n    pg_stat_statements.dbid,\n    pg_stat_statements.toplevel,\n    pg_stat_statements.queryid,\n    pg_stat_statements.query,\n    pg_stat_statements.plans,\n    pg_stat_statements.total_plan_time,\n    pg_stat_statements.min_plan_time,\n    pg_stat_statements.max_plan_time,\n    pg_stat_statements.mean_plan_time,\n    pg_stat_statements.stddev_plan_time,\n    pg_stat_statements.calls,\n    pg_stat_statements.total_exec_time,\n    pg_stat_statements.min_exec_time,\n    pg_stat_statements.max_exec_time,\n    pg_stat_statements.mean_exec_time,\n    pg_stat_statements.stddev_exec_time,\n    pg_stat_statements.rows,\n    pg_stat_statements.shared_blks_hit,\n    pg_stat_statements.shared_blks_read,\n    pg_stat_statements.shared_blks_dirtied,\n    pg_stat_statements.shared_blks_written,\n    pg_stat_statements.local_blks_hit,\n    pg_stat_statements.local_blks_read,\n    pg_stat_statements.local_blks_dirtied,\n    pg_stat_statements.local_blks_written,\n    pg_stat_statements.temp_blks_read,\n    pg_stat_statements.temp_blks_written,\n    pg_stat_statements.blk_read_time,\n    pg_stat_statements.blk_write_time,\n    pg_stat_statements.temp_blk_read_time,\n    pg_stat_statements.temp_blk_write_time,\n    pg_stat_statements.wal_records,\n    pg_stat_statements.wal_fpi,\n    pg_stat_statements.wal_bytes,\n    pg_stat_statements.jit_functions,\n    pg_stat_statements.jit_generation_time,\n    pg_stat_statements.jit_inlining_count,\n    pg_stat_statements.jit_inlining_time,\n    pg_stat_statements.jit_optimization_count,\n    pg_stat_statements.jit_optimization_time,\n    pg_stat_statements.jit_emission_count,\n    pg_stat_statements.jit_emission_time\n   FROM metric_helpers.pg_stat_statements(true) pg_stat_statements(userid, dbid, toplevel, queryid, query, plans, total_plan_time, min_plan_time, max_plan_time, mean_plan_time, stddev_plan_time, calls, total_exec_time, min_exec_time, max_exec_time, mean_exec_time, stddev_exec_time, rows, shared_blks_hit, shared_blks_read, shared_blks_dirtied, shared_blks_written, local_blks_hit, local_blks_read, local_blks_dirtied, local_blks_written, temp_blks_read, temp_blks_written, blk_read_time, blk_write_time, temp_blk_read_time, temp_blk_write_time, wal_records, wal_fpi, wal_bytes, jit_functions, jit_generation_time, jit_inlining_count, jit_inlining_time, jit_optimization_count, jit_optimization_time, jit_emission_count, jit_emission_time);\n\n\npg_restore: error: could not execute query: ERROR:  relation \"table_bloat\" already exists\nCommand was: CREATE VIEW metric_helpers.table_bloat AS\n SELECT get_table_bloat_approx.t_database,\n    get_table_bloat_approx.t_schema_name,\n    get_table_bloat_approx.t_table_name,\n    get_table_bloat_approx.t_real_size,\n    get_table_bloat_approx.t_extra_size,\n    get_table_bloat_approx.t_extra_ratio,\n    get_table_bloat_approx.t_fill_factor,\n    get_table_bloat_approx.t_bloat_size,\n    get_table_bloat_approx.t_bloat_ratio,\n    get_table_bloat_approx.t_is_na\n   FROM metric_helpers.get_table_bloat_approx() get_table_bloat_approx(t_database, t_schema_name, t_table_name, t_real_size, t_extra_size, t_extra_ratio, t_fill_factor, t_bloat_size, t_bloat_ratio, t_is_na);\n\n\npg_restore: warning: errors ignored on restore: 18",
    "stderr_lines": [
        "pg_restore: error: could not execute query: ERROR:  unrecognized configuration parameter \"transaction_timeout\"",
        "Command was: SET transaction_timeout = 0;",
        "pg_restore: error: could not execute query: ERROR:  schema \"metric_helpers\" already exists",
        "Command was: CREATE SCHEMA metric_helpers;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  schema \"user_management\" already exists",
        "Command was: CREATE SCHEMA user_management;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"get_btree_bloat_approx\" already exists with same argument types",
        "Command was: CREATE FUNCTION metric_helpers.get_btree_bloat_approx(OUT i_database name, OUT i_schema_name name, OUT i_table_name name, OUT i_index_name name, OUT i_real_size numeric, OUT i_extra_size numeric, OUT i_extra_ratio double precision, OUT i_fill_factor integer, OUT i_bloat_size double precision, OUT i_bloat_ratio double precision, OUT i_is_na boolean) RETURNS SETOF record",
        "    LANGUAGE sql IMMUTABLE STRICT SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $$",
        "SELECT current_database(), nspname AS schemaname, tblname, idxname, bs*(relpages)::bigint AS real_size,",
        "  bs*(relpages-est_pages)::bigint AS extra_size,",
        "  100 * (relpages-est_pages)::float / relpages AS extra_ratio,",
        "  fillfactor,",
        "  CASE WHEN relpages > est_pages_ff",
        "    THEN bs*(relpages-est_pages_ff)",
        "    ELSE 0",
        "  END AS bloat_size,",
        "  100 * (relpages-est_pages_ff)::float / relpages AS bloat_ratio,",
        "  is_na",
        "  -- , 100-(pst).avg_leaf_density AS pst_avg_bloat, est_pages, index_tuple_hdr_bm, maxalign, pagehdr, nulldatawidth, nulldatahdrwidth, reltuples, relpages -- (DEBUG INFO)",
        "FROM (",
        "  SELECT coalesce(1 +",
        "         ceil(reltuples/floor((bs-pageopqdata-pagehdr)/(4+nulldatahdrwidth)::float)), 0 -- ItemIdData size + computed avg size of a tuple (nulldatahdrwidth)",
        "      ) AS est_pages,",
        "      coalesce(1 +",
        "         ceil(reltuples/floor((bs-pageopqdata-pagehdr)*fillfactor/(100*(4+nulldatahdrwidth)::float))), 0",
        "      ) AS est_pages_ff,",
        "      bs, nspname, tblname, idxname, relpages, fillfactor, is_na",
        "      -- , pgstatindex(idxoid) AS pst, index_tuple_hdr_bm, maxalign, pagehdr, nulldatawidth, nulldatahdrwidth, reltuples -- (DEBUG INFO)",
        "  FROM (",
        "      SELECT maxalign, bs, nspname, tblname, idxname, reltuples, relpages, idxoid, fillfactor,",
        "            ( index_tuple_hdr_bm +",
        "                maxalign - CASE -- Add padding to the index tuple header to align on MAXALIGN",
        "                  WHEN index_tuple_hdr_bm%maxalign = 0 THEN maxalign",
        "                  ELSE index_tuple_hdr_bm%maxalign",
        "                END",
        "              + nulldatawidth + maxalign - CASE -- Add padding to the data to align on MAXALIGN",
        "                  WHEN nulldatawidth = 0 THEN 0",
        "                  WHEN nulldatawidth::integer%maxalign = 0 THEN maxalign",
        "                  ELSE nulldatawidth::integer%maxalign",
        "                END",
        "            )::numeric AS nulldatahdrwidth, pagehdr, pageopqdata, is_na",
        "            -- , index_tuple_hdr_bm, nulldatawidth -- (DEBUG INFO)",
        "      FROM (",
        "          SELECT n.nspname, ct.relname AS tblname, i.idxname, i.reltuples, i.relpages,",
        "              i.idxoid, i.fillfactor, current_setting('block_size')::numeric AS bs,",
        "              CASE -- MAXALIGN: 4 on 32bits, 8 on 64bits (and mingw32 ?)",
        "                WHEN version() ~ 'mingw32' OR version() ~ '64-bit|x86_64|ppc64|ia64|amd64' THEN 8",
        "                ELSE 4",
        "              END AS maxalign,",
        "              /* per page header, fixed size: 20 for 7.X, 24 for others */",
        "              24 AS pagehdr,",
        "              /* per page btree opaque data */",
        "              16 AS pageopqdata,",
        "              /* per tuple header: add IndexAttributeBitMapData if some cols are null-able */",
        "              CASE WHEN max(coalesce(s.stanullfrac,0)) = 0",
        "                  THEN 2 -- IndexTupleData size",
        "                  ELSE 2 + (( 32 + 8 - 1 ) / 8) -- IndexTupleData size + IndexAttributeBitMapData size ( max num filed per index + 8 - 1 /8)",
        "              END AS index_tuple_hdr_bm,",
        "              /* data len: we remove null values save space using it fractionnal part from stats */",
        "              sum( (1-coalesce(s.stanullfrac, 0)) * coalesce(s.stawidth, 1024)) AS nulldatawidth,",
        "              max( CASE WHEN a.atttypid = 'pg_catalog.name'::regtype THEN 1 ELSE 0 END ) > 0 AS is_na",
        "          FROM (",
        "              SELECT idxname, reltuples, relpages, tbloid, idxoid, fillfactor,",
        "                  CASE WHEN indkey[i]=0 THEN idxoid ELSE tbloid END AS att_rel,",
        "                  CASE WHEN indkey[i]=0 THEN i ELSE indkey[i] END AS att_pos",
        "              FROM (",
        "                  SELECT idxname, reltuples, relpages, tbloid, idxoid, fillfactor, indkey, generate_series(1,indnatts) AS i",
        "                  FROM (",
        "                      SELECT ci.relname AS idxname, ci.reltuples, ci.relpages, i.indrelid AS tbloid,",
        "                          i.indexrelid AS idxoid,",
        "                          coalesce(substring(",
        "                              array_to_string(ci.reloptions, ' ')",
        "                              from 'fillfactor=([0-9]+)')::smallint, 90) AS fillfactor,",
        "                          i.indnatts,",
        "                          string_to_array(textin(int2vectorout(i.indkey)),' ')::int[] AS indkey",
        "                      FROM pg_index i",
        "                      JOIN pg_class ci ON ci.oid=i.indexrelid",
        "                      WHERE ci.relam=(SELECT oid FROM pg_am WHERE amname = 'btree')",
        "                        AND ci.relpages > 0",
        "                  ) AS idx_data",
        "              ) AS idx_data_cross",
        "          ) i",
        "          JOIN pg_attribute a ON a.attrelid = i.att_rel",
        "                             AND a.attnum = i.att_pos",
        "          JOIN pg_statistic s ON s.starelid = i.att_rel",
        "                             AND s.staattnum = i.att_pos",
        "          JOIN pg_class ct ON ct.oid = i.tbloid",
        "          JOIN pg_namespace n ON ct.relnamespace = n.oid",
        "          GROUP BY 1,2,3,4,5,6,7,8,9,10",
        "      ) AS rows_data_stats",
        "  ) AS rows_hdr_pdg_stats",
        ") AS relation_stats;",
        "$$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"get_table_bloat_approx\" already exists with same argument types",
        "Command was: CREATE FUNCTION metric_helpers.get_table_bloat_approx(OUT t_database name, OUT t_schema_name name, OUT t_table_name name, OUT t_real_size numeric, OUT t_extra_size double precision, OUT t_extra_ratio double precision, OUT t_fill_factor integer, OUT t_bloat_size double precision, OUT t_bloat_ratio double precision, OUT t_is_na boolean) RETURNS SETOF record",
        "    LANGUAGE sql IMMUTABLE STRICT SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $$",
        "SELECT",
        "  current_database(),",
        "  schemaname,",
        "  tblname,",
        "  (bs*tblpages) AS real_size,",
        "  ((tblpages-est_tblpages)*bs) AS extra_size,",
        "  CASE WHEN tblpages - est_tblpages > 0",
        "    THEN 100 * (tblpages - est_tblpages)/tblpages::float",
        "    ELSE 0",
        "  END AS extra_ratio,",
        "  fillfactor,",
        "  CASE WHEN tblpages - est_tblpages_ff > 0",
        "    THEN (tblpages-est_tblpages_ff)*bs",
        "    ELSE 0",
        "  END AS bloat_size,",
        "  CASE WHEN tblpages - est_tblpages_ff > 0",
        "    THEN 100 * (tblpages - est_tblpages_ff)/tblpages::float",
        "    ELSE 0",
        "  END AS bloat_ratio,",
        "  is_na",
        "FROM (",
        "  SELECT ceil( reltuples / ( (bs-page_hdr)/tpl_size ) ) + ceil( toasttuples / 4 ) AS est_tblpages,",
        "    ceil( reltuples / ( (bs-page_hdr)*fillfactor/(tpl_size*100) ) ) + ceil( toasttuples / 4 ) AS est_tblpages_ff,",
        "    tblpages, fillfactor, bs, tblid, schemaname, tblname, heappages, toastpages, is_na",
        "    -- , tpl_hdr_size, tpl_data_size, pgstattuple(tblid) AS pst -- (DEBUG INFO)",
        "  FROM (",
        "    SELECT",
        "      ( 4 + tpl_hdr_size + tpl_data_size + (2*ma)",
        "        - CASE WHEN tpl_hdr_size%ma = 0 THEN ma ELSE tpl_hdr_size%ma END",
        "        - CASE WHEN ceil(tpl_data_size)::int%ma = 0 THEN ma ELSE ceil(tpl_data_size)::int%ma END",
        "      ) AS tpl_size, bs - page_hdr AS size_per_block, (heappages + toastpages) AS tblpages, heappages,",
        "      toastpages, reltuples, toasttuples, bs, page_hdr, tblid, schemaname, tblname, fillfactor, is_na",
        "      -- , tpl_hdr_size, tpl_data_size",
        "    FROM (",
        "      SELECT",
        "        tbl.oid AS tblid, ns.nspname AS schemaname, tbl.relname AS tblname, tbl.reltuples,",
        "        tbl.relpages AS heappages, coalesce(toast.relpages, 0) AS toastpages,",
        "        coalesce(toast.reltuples, 0) AS toasttuples,",
        "        coalesce(substring(",
        "          array_to_string(tbl.reloptions, ' ')",
        "          FROM 'fillfactor=([0-9]+)')::smallint, 100) AS fillfactor,",
        "        current_setting('block_size')::numeric AS bs,",
        "        CASE WHEN version()~'mingw32' OR version()~'64-bit|x86_64|ppc64|ia64|amd64' THEN 8 ELSE 4 END AS ma,",
        "        24 AS page_hdr,",
        "        23 + CASE WHEN MAX(coalesce(s.null_frac,0)) > 0 THEN ( 7 + count(s.attname) ) / 8 ELSE 0::int END",
        "           + CASE WHEN bool_or(att.attname = 'oid' and att.attnum < 0) THEN 4 ELSE 0 END AS tpl_hdr_size,",
        "        sum( (1-coalesce(s.null_frac, 0)) * coalesce(s.avg_width, 0) ) AS tpl_data_size,",
        "        bool_or(att.atttypid = 'pg_catalog.name'::regtype)",
        "          OR sum(CASE WHEN att.attnum > 0 THEN 1 ELSE 0 END) <> count(s.attname) AS is_na",
        "      FROM pg_attribute AS att",
        "        JOIN pg_class AS tbl ON att.attrelid = tbl.oid",
        "        JOIN pg_namespace AS ns ON ns.oid = tbl.relnamespace",
        "        LEFT JOIN pg_stats AS s ON s.schemaname=ns.nspname",
        "          AND s.tablename = tbl.relname AND s.inherited=false AND s.attname=att.attname",
        "        LEFT JOIN pg_class AS toast ON tbl.reltoastrelid = toast.oid",
        "      WHERE NOT att.attisdropped",
        "        AND tbl.relkind = 'r'",
        "      GROUP BY 1,2,3,4,5,6,7,8,9,10",
        "      ORDER BY 2,3",
        "    ) AS s",
        "  ) AS s2",
        ") AS s3 WHERE schemaname NOT LIKE 'information_schema';",
        "$$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"pg_stat_statements\" already exists with same argument types",
        "Command was: CREATE FUNCTION metric_helpers.pg_stat_statements(showtext boolean) RETURNS SETOF public.pg_stat_statements",
        "    LANGUAGE sql IMMUTABLE STRICT SECURITY DEFINER",
        "    AS $$",
        "  SELECT * FROM public.pg_stat_statements(showtext);",
        "$$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"create_application_user\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.create_application_user(username text) RETURNS text",
        "    LANGUAGE plpgsql SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $_$",
        "DECLARE",
        "    pw text;",
        "BEGIN",
        "    SELECT user_management.random_password(20) INTO pw;",
        "    EXECUTE format($$ CREATE USER %I WITH PASSWORD %L $$, username, pw);",
        "    RETURN pw;",
        "END",
        "$_$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"create_application_user_or_change_password\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.create_application_user_or_change_password(username text, password text) RETURNS void",
        "    LANGUAGE plpgsql SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $_$",
        "BEGIN",
        "    PERFORM 1 FROM pg_roles WHERE rolname = username;",
        "",
        "    IF FOUND",
        "    THEN",
        "        EXECUTE format($$ ALTER ROLE %I WITH PASSWORD %L $$, username, password);",
        "    ELSE",
        "        EXECUTE format($$ CREATE USER %I WITH PASSWORD %L $$, username, password);",
        "    END IF;",
        "END",
        "$_$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"create_role\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.create_role(rolename text) RETURNS void",
        "    LANGUAGE plpgsql SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $_$",
        "BEGIN",
        "    -- set ADMIN to the admin user, so every member of admin can GRANT these roles to each other",
        "    EXECUTE format($$ CREATE ROLE %I WITH ADMIN admin $$, rolename);",
        "END;",
        "$_$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"create_user\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.create_user(username text) RETURNS void",
        "    LANGUAGE plpgsql SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $_$",
        "BEGIN",
        "    EXECUTE format($$ CREATE USER %I IN ROLE zalandos, admin $$, username);",
        "    EXECUTE format($$ ALTER ROLE %I SET log_statement TO 'all' $$, username);",
        "END;",
        "$_$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"drop_role\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.drop_role(username text) RETURNS void",
        "    LANGUAGE sql SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $$",
        "SELECT user_management.drop_user(username);",
        "$$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"drop_user\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.drop_user(username text) RETURNS void",
        "    LANGUAGE plpgsql SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $_$",
        "BEGIN",
        "    EXECUTE format($$ DROP ROLE %I $$, username);",
        "END",
        "$_$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"random_password\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.random_password(length integer) RETURNS text",
        "    LANGUAGE sql",
        "    SET search_path TO 'pg_catalog'",
        "    AS $$",
        "WITH chars (c) AS (",
        "    SELECT chr(33)",
        "    UNION ALL",
        "    SELECT chr(i) FROM generate_series (35, 38) AS t (i)",
        "    UNION ALL",
        "    SELECT chr(i) FROM generate_series (42, 90) AS t (i)",
        "    UNION ALL",
        "    SELECT chr(i) FROM generate_series (97, 122) AS t (i)",
        "),",
        "bricks (b) AS (",
        "    -- build a pool of chars (the size will be the number of chars above times length)",
        "    -- and shuffle it",
        "    SELECT c FROM chars, generate_series(1, length) ORDER BY random()",
        ")",
        "SELECT substr(string_agg(b, ''), 1, length) FROM bricks;",
        "$$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"revoke_admin\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.revoke_admin(username text) RETURNS void",
        "    LANGUAGE plpgsql SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $_$",
        "BEGIN",
        "    EXECUTE format($$ REVOKE admin FROM %I $$, username);",
        "END",
        "$_$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  function \"terminate_backend\" already exists with same argument types",
        "Command was: CREATE FUNCTION user_management.terminate_backend(pid integer) RETURNS boolean",
        "    LANGUAGE sql SECURITY DEFINER",
        "    SET search_path TO 'pg_catalog'",
        "    AS $$",
        "SELECT pg_terminate_backend(pid);",
        "$$;",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  relation \"index_bloat\" already exists",
        "Command was: CREATE VIEW metric_helpers.index_bloat AS",
        " SELECT get_btree_bloat_approx.i_database,",
        "    get_btree_bloat_approx.i_schema_name,",
        "    get_btree_bloat_approx.i_table_name,",
        "    get_btree_bloat_approx.i_index_name,",
        "    get_btree_bloat_approx.i_real_size,",
        "    get_btree_bloat_approx.i_extra_size,",
        "    get_btree_bloat_approx.i_extra_ratio,",
        "    get_btree_bloat_approx.i_fill_factor,",
        "    get_btree_bloat_approx.i_bloat_size,",
        "    get_btree_bloat_approx.i_bloat_ratio,",
        "    get_btree_bloat_approx.i_is_na",
        "   FROM metric_helpers.get_btree_bloat_approx() get_btree_bloat_approx(i_database, i_schema_name, i_table_name, i_index_name, i_real_size, i_extra_size, i_extra_ratio, i_fill_factor, i_bloat_size, i_bloat_ratio, i_is_na);",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  relation \"pg_stat_statements\" already exists",
        "Command was: CREATE VIEW metric_helpers.pg_stat_statements AS",
        " SELECT pg_stat_statements.userid,",
        "    pg_stat_statements.dbid,",
        "    pg_stat_statements.toplevel,",
        "    pg_stat_statements.queryid,",
        "    pg_stat_statements.query,",
        "    pg_stat_statements.plans,",
        "    pg_stat_statements.total_plan_time,",
        "    pg_stat_statements.min_plan_time,",
        "    pg_stat_statements.max_plan_time,",
        "    pg_stat_statements.mean_plan_time,",
        "    pg_stat_statements.stddev_plan_time,",
        "    pg_stat_statements.calls,",
        "    pg_stat_statements.total_exec_time,",
        "    pg_stat_statements.min_exec_time,",
        "    pg_stat_statements.max_exec_time,",
        "    pg_stat_statements.mean_exec_time,",
        "    pg_stat_statements.stddev_exec_time,",
        "    pg_stat_statements.rows,",
        "    pg_stat_statements.shared_blks_hit,",
        "    pg_stat_statements.shared_blks_read,",
        "    pg_stat_statements.shared_blks_dirtied,",
        "    pg_stat_statements.shared_blks_written,",
        "    pg_stat_statements.local_blks_hit,",
        "    pg_stat_statements.local_blks_read,",
        "    pg_stat_statements.local_blks_dirtied,",
        "    pg_stat_statements.local_blks_written,",
        "    pg_stat_statements.temp_blks_read,",
        "    pg_stat_statements.temp_blks_written,",
        "    pg_stat_statements.blk_read_time,",
        "    pg_stat_statements.blk_write_time,",
        "    pg_stat_statements.temp_blk_read_time,",
        "    pg_stat_statements.temp_blk_write_time,",
        "    pg_stat_statements.wal_records,",
        "    pg_stat_statements.wal_fpi,",
        "    pg_stat_statements.wal_bytes,",
        "    pg_stat_statements.jit_functions,",
        "    pg_stat_statements.jit_generation_time,",
        "    pg_stat_statements.jit_inlining_count,",
        "    pg_stat_statements.jit_inlining_time,",
        "    pg_stat_statements.jit_optimization_count,",
        "    pg_stat_statements.jit_optimization_time,",
        "    pg_stat_statements.jit_emission_count,",
        "    pg_stat_statements.jit_emission_time",
        "   FROM metric_helpers.pg_stat_statements(true) pg_stat_statements(userid, dbid, toplevel, queryid, query, plans, total_plan_time, min_plan_time, max_plan_time, mean_plan_time, stddev_plan_time, calls, total_exec_time, min_exec_time, max_exec_time, mean_exec_time, stddev_exec_time, rows, shared_blks_hit, shared_blks_read, shared_blks_dirtied, shared_blks_written, local_blks_hit, local_blks_read, local_blks_dirtied, local_blks_written, temp_blks_read, temp_blks_written, blk_read_time, blk_write_time, temp_blk_read_time, temp_blk_write_time, wal_records, wal_fpi, wal_bytes, jit_functions, jit_generation_time, jit_inlining_count, jit_inlining_time, jit_optimization_count, jit_optimization_time, jit_emission_count, jit_emission_time);",
        "",
        "",
        "pg_restore: error: could not execute query: ERROR:  relation \"table_bloat\" already exists",
        "Command was: CREATE VIEW metric_helpers.table_bloat AS",
        " SELECT get_table_bloat_approx.t_database,",
        "    get_table_bloat_approx.t_schema_name,",
        "    get_table_bloat_approx.t_table_name,",
        "    get_table_bloat_approx.t_real_size,",
        "    get_table_bloat_approx.t_extra_size,",
        "    get_table_bloat_approx.t_extra_ratio,",
        "    get_table_bloat_approx.t_fill_factor,",
        "    get_table_bloat_approx.t_bloat_size,",
        "    get_table_bloat_approx.t_bloat_ratio,",
        "    get_table_bloat_approx.t_is_na",
        "   FROM metric_helpers.get_table_bloat_approx() get_table_bloat_approx(t_database, t_schema_name, t_table_name, t_real_size, t_extra_size, t_extra_ratio, t_fill_factor, t_bloat_size, t_bloat_ratio, t_is_na);",
        "",
        "",
        "pg_restore: warning: errors ignored on restore: 18"
    ],
    "stdout": "",
    "stdout_lines": []
}
...ignoring

TASK [include_role : ../roles/common-scale] ************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:102
included: ../roles/common-scale for localhost

TASK [../roles/common-scale : Scale up OrgPod backend replicas] ****************
task path: /home/you/Desktop/ansible_db_migration_scripts/roles/common-scale/tasks/replica-up.yaml:1
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538095.6099834-25799-235254019685930 `" && echo ansible-tmp-1754538095.6099834-25799-235254019685930="` echo /home/you/.ansible/tmp/ansible-tmp-1754538095.6099834-25799-235254019685930 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible_collections/kubernetes/core/plugins/modules/k8s.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmp4xtoyyvz TO /home/you/.ansible/tmp/ansible-tmp-1754538095.6099834-25799-235254019685930/AnsiballZ_k8s.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538095.6099834-25799-235254019685930/ /home/you/.ansible/tmp/ansible-tmp-1754538095.6099834-25799-235254019685930/AnsiballZ_k8s.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538095.6099834-25799-235254019685930/AnsiballZ_k8s.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538095.6099834-25799-235254019685930/ > /dev/null 2>&1 && sleep 0'
changed: [localhost] => {
    "changed": true,
    "invocation": {
        "module_args": {
            "api_key": null,
            "api_version": "v1",
            "append_hash": false,
            "apply": false,
            "ca_cert": null,
            "client_cert": null,
            "client_key": null,
            "context": null,
            "continue_on_error": false,
            "definition": {
                "apiVersion": "webapp.aes.dev/v1",
                "kind": "OrgPod",
                "metadata": {
                    "name": "cortezapod",
                    "namespace": "cortezadevops-qa-ofzt-ns"
                },
                "spec": {
                    "backendReplicas": 1
                }
            },
            "delete_all": false,
            "delete_options": null,
            "force": false,
            "generate_name": null,
            "hidden_fields": null,
            "host": null,
            "impersonate_groups": null,
            "impersonate_user": null,
            "kind": null,
            "kubeconfig": "VALUE_SPECIFIED_IN_NO_LOG_PARAMETER",
            "label_selectors": null,
            "merge_type": null,
            "name": null,
            "namespace": "cortezadevops-qa-ofzt-ns",
            "no_proxy": null,
            "password": null,
            "persist_config": null,
            "proxy": null,
            "proxy_headers": null,
            "resource_definition": {
                "apiVersion": "webapp.aes.dev/v1",
                "kind": "OrgPod",
                "metadata": {
                    "name": "cortezapod",
                    "namespace": "cortezadevops-qa-ofzt-ns"
                },
                "spec": {
                    "backendReplicas": 1
                }
            },
            "server_side_apply": null,
            "src": null,
            "state": "present",
            "template": null,
            "username": null,
            "validate": null,
            "validate_certs": null,
            "wait": false,
            "wait_condition": null,
            "wait_sleep": 5,
            "wait_timeout": 120
        }
    },
    "method": "update",
    "result": {
        "apiVersion": "webapp.aes.dev/v1",
        "kind": "OrgPod",
        "metadata": {
            "creationTimestamp": "2025-08-06T05:54:36Z",
            "finalizers": [
                "k8s.io/aesorg"
            ],
            "generation": 18,
            "managedFields": [
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            ".": {},
                            "f:host": {},
                            "f:path": {},
                            "f:port": {},
                            "f:pvSize": {}
                        }
                    },
                    "manager": "cgornd",
                    "operation": "Update",
                    "time": "2025-08-06T05:54:36Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:metadata": {
                            "f:finalizers": {
                                ".": {},
                                "v:\"k8s.io/aesorg\"": {}
                            }
                        }
                    },
                    "manager": "manager",
                    "operation": "Update",
                    "time": "2025-08-06T05:54:36Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:status": {
                            ".": {},
                            "f:ready": {},
                            "f:states": {}
                        }
                    },
                    "manager": "manager",
                    "operation": "Update",
                    "subresource": "status",
                    "time": "2025-08-06T05:54:36Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            "f:environmentVariables": {},
                            "f:orgImg": {}
                        }
                    },
                    "manager": "kubectl-edit",
                    "operation": "Update",
                    "time": "2025-08-07T03:17:59Z"
                },
                {
                    "apiVersion": "webapp.aes.dev/v1",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:spec": {
                            "f:backendReplicas": {}
                        }
                    },
                    "manager": "OpenAPI-Generator",
                    "operation": "Update",
                    "time": "2025-08-07T03:41:35Z"
                }
            ],
            "name": "cortezapod",
            "namespace": "cortezadevops-qa-ofzt-ns",
            "resourceVersion": "36824333",
            "uid": "b906fda3-872e-4a78-90b8-96d61ae2fef4"
        },
        "spec": {
            "backendReplicas": 1,
            "environmentVariables": [
                {
                    "name": "DOMAIN",
                    "value": "172.17.17.163"
                },
                {
                    "name": "SMTP_HOST",
                    "value": "mail.smtp2go.com"
                },
                {
                    "name": "SMTP_PORT",
                    "value": "465"
                },
                {
                    "name": "SMTP_USER",
                    "value": "cortezauser"
                },
                {
                    "name": "SMTP_PASS",
                    "value": "3a3igTLqGx8iMkXe"
                },
                {
                    "name": "SMTP_FROM",
                    "value": "donotreply@quickops.io"
                },
                {
                    "name": "SMTP_SECURE",
                    "value": "true"
                },
                {
                    "name": "SMTP_AUTH_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ENVIRONMENT",
                    "value": "production"
                },
                {
                    "name": "VERSION",
                    "value": "2024.9"
                },
                {
                    "name": "DB_DSN",
                    "value": "postgres://rootuser:superAdmin@cortezadbtest-db-cluster:5432/corteza?sslmode=require"
                },
                {
                    "name": "HTTP_WEBAPP_ENABLED",
                    "value": "true"
                },
                {
                    "name": "AUTH_GARBAGE_COLLECTOR_INTERVAL",
                    "value": "60min"
                },
                {
                    "name": "ACTIONLOG_ENABLED",
                    "value": "true"
                },
                {
                    "name": "AUTH_REQUEST_RATE_LIMIT",
                    "value": "600000"
                },
                {
                    "name": "AUTH_REQUEST_RATE_WINDOW_LENGTH",
                    "value": "600000m"
                },
                {
                    "name": "DB_MAX_OPEN_CONNS",
                    "value": "6000"
                },
                {
                    "name": "DB_MAX_IDLE_CONNS",
                    "value": "300"
                },
                {
                    "name": "AUTH_DEVELOPMENT_MODE",
                    "value": "false"
                },
                {
                    "name": "SESSION_COOKIE_SECURE",
                    "value": "true"
                },
                {
                    "name": "HOSTNAME",
                    "value": "172.17.17.163"
                },
                {
                    "name": "HTTP_SECURE",
                    "value": "true"
                },
                {
                    "name": "AUTH_CSRF_ENABLED",
                    "value": "false"
                },
                {
                    "name": "EVENTBUS_SCHEDULER_ENABLED",
                    "value": "true"
                },
                {
                    "name": "EVENTBUS_SCHEDULER_INTERVAL",
                    "value": "180s"
                },
                {
                    "name": "LOCALE_LOG",
                    "value": "true"
                },
                {
                    "name": "APIGW_LOG_REQUESTBODY",
                    "value": "true"
                },
                {
                    "name": "APIGW_LOG_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ACTIONLOG_WORKFLOW_FUNCTIONS_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ACTIONLOG_ENABLED",
                    "value": "true"
                },
                {
                    "name": "ACTIONLOG_DEBUG",
                    "value": "true"
                }
            ],
            "host": true,
            "orgImg": "devopsaes/corteza:1.38",
            "path": "/data",
            "port": 80,
            "pvSize": 5000
        },
        "status": {
            "ready": true,
            "states": [
                {
                    "message": "Orgpod backend is ready",
                    "metadata": {},
                    "reason": "All replicas are ready"
                }
            ]
        }
    }
}

TASK [Application health check] ************************************************
task path: /home/you/Desktop/ansible_db_migration_scripts/playbooks/main.yaml:111
<localhost> ESTABLISH LOCAL CONNECTION FOR USER: you
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538096.3108697-25824-243654256625083 `" && echo ansible-tmp-1754538096.3108697-25824-243654256625083="` echo /home/you/.ansible/tmp/ansible-tmp-1754538096.3108697-25824-243654256625083 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/uri.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpzhbjq_0o TO /home/you/.ansible/tmp/ansible-tmp-1754538096.3108697-25824-243654256625083/AnsiballZ_uri.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538096.3108697-25824-243654256625083/ /home/you/.ansible/tmp/ansible-tmp-1754538096.3108697-25824-243654256625083/AnsiballZ_uri.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538096.3108697-25824-243654256625083/AnsiballZ_uri.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538096.3108697-25824-243654256625083/ > /dev/null 2>&1 && sleep 0'
FAILED - RETRYING: [localhost]: Application health check (5 retries left).Result was: {
    "access_control_allow_credentials": "true",
    "access_control_allow_headers": "DNT,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization",
    "access_control_allow_methods": "GET, PUT, POST, DELETE, PATCH, OPTIONS",
    "access_control_allow_origin": "*",
    "access_control_max_age": "1728000",
    "attempts": 1,
    "changed": false,
    "connection": "close",
    "content_length": "190",
    "content_type": "text/html",
    "date": "Thu, 07 Aug 2025 03:41:36 GMT",
    "elapsed": 0,
    "invocation": {
        "module_args": {
            "attributes": null,
            "body": null,
            "body_format": "raw",
            "ca_path": null,
            "ciphers": null,
            "client_cert": null,
            "client_key": null,
            "creates": null,
            "decompress": true,
            "dest": null,
            "follow_redirects": "safe",
            "force": false,
            "force_basic_auth": false,
            "group": null,
            "headers": {},
            "http_agent": "ansible-httpget",
            "method": "GET",
            "mode": null,
            "owner": null,
            "remote_src": false,
            "removes": null,
            "return_content": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "status_code": [
                200
            ],
            "timeout": 30,
            "unix_socket": null,
            "unredirected_headers": [],
            "unsafe_writes": false,
            "url": "http://172.17.17.163/health/",
            "url_password": null,
            "url_username": null,
            "use_gssapi": false,
            "use_netrc": true,
            "use_proxy": true,
            "validate_certs": true
        }
    },
    "msg": "Status code was 503 and not [200]: HTTP Error 503: Service Temporarily Unavailable",
    "redirected": false,
    "retries": 6,
    "status": 503,
    "url": "http://172.17.17.163/health/"
}
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538106.4983902-25824-14211170361269 `" && echo ansible-tmp-1754538106.4983902-25824-14211170361269="` echo /home/you/.ansible/tmp/ansible-tmp-1754538106.4983902-25824-14211170361269 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/uri.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpjudnz2fu TO /home/you/.ansible/tmp/ansible-tmp-1754538106.4983902-25824-14211170361269/AnsiballZ_uri.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538106.4983902-25824-14211170361269/ /home/you/.ansible/tmp/ansible-tmp-1754538106.4983902-25824-14211170361269/AnsiballZ_uri.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538106.4983902-25824-14211170361269/AnsiballZ_uri.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538106.4983902-25824-14211170361269/ > /dev/null 2>&1 && sleep 0'
FAILED - RETRYING: [localhost]: Application health check (4 retries left).Result was: {
    "access_control_allow_credentials": "true",
    "access_control_allow_headers": "DNT,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization",
    "access_control_allow_methods": "GET, PUT, POST, DELETE, PATCH, OPTIONS",
    "access_control_allow_origin": "*",
    "access_control_max_age": "1728000",
    "attempts": 2,
    "changed": false,
    "connection": "close",
    "content_length": "190",
    "content_type": "text/html",
    "date": "Thu, 07 Aug 2025 03:41:46 GMT",
    "elapsed": 0,
    "invocation": {
        "module_args": {
            "attributes": null,
            "body": null,
            "body_format": "raw",
            "ca_path": null,
            "ciphers": null,
            "client_cert": null,
            "client_key": null,
            "creates": null,
            "decompress": true,
            "dest": null,
            "follow_redirects": "safe",
            "force": false,
            "force_basic_auth": false,
            "group": null,
            "headers": {},
            "http_agent": "ansible-httpget",
            "method": "GET",
            "mode": null,
            "owner": null,
            "remote_src": false,
            "removes": null,
            "return_content": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "status_code": [
                200
            ],
            "timeout": 30,
            "unix_socket": null,
            "unredirected_headers": [],
            "unsafe_writes": false,
            "url": "http://172.17.17.163/health/",
            "url_password": null,
            "url_username": null,
            "use_gssapi": false,
            "use_netrc": true,
            "use_proxy": true,
            "validate_certs": true
        }
    },
    "msg": "Status code was 503 and not [200]: HTTP Error 503: Service Temporarily Unavailable",
    "redirected": false,
    "retries": 6,
    "status": 503,
    "url": "http://172.17.17.163/health/"
}
<localhost> EXEC /bin/sh -c 'echo ~you && sleep 0'
<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/you/.ansible/tmp `"&& mkdir "` echo /home/you/.ansible/tmp/ansible-tmp-1754538116.7049851-25824-32169271318061 `" && echo ansible-tmp-1754538116.7049851-25824-32169271318061="` echo /home/you/.ansible/tmp/ansible-tmp-1754538116.7049851-25824-32169271318061 `" ) && sleep 0'
Using module file /home/you/ansible-venv/lib/python3.12/site-packages/ansible/modules/uri.py
<localhost> PUT /home/you/.ansible/tmp/ansible-local-24782nedt6gd2/tmpicnevchj TO /home/you/.ansible/tmp/ansible-tmp-1754538116.7049851-25824-32169271318061/AnsiballZ_uri.py
<localhost> EXEC /bin/sh -c 'chmod u+rwx /home/you/.ansible/tmp/ansible-tmp-1754538116.7049851-25824-32169271318061/ /home/you/.ansible/tmp/ansible-tmp-1754538116.7049851-25824-32169271318061/AnsiballZ_uri.py && sleep 0'
<localhost> EXEC /bin/sh -c '/home/you/ansible-venv/bin/python3.12 /home/you/.ansible/tmp/ansible-tmp-1754538116.7049851-25824-32169271318061/AnsiballZ_uri.py && sleep 0'
<localhost> EXEC /bin/sh -c 'rm -f -r /home/you/.ansible/tmp/ansible-tmp-1754538116.7049851-25824-32169271318061/ > /dev/null 2>&1 && sleep 0'
ok: [localhost] => {
    "access_control_allow_credentials": "true",
    "access_control_allow_headers": "DNT,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization",
    "access_control_allow_methods": "GET, PUT, POST, DELETE, PATCH, OPTIONS",
    "access_control_allow_origin": "*",
    "access_control_max_age": "1728000",
    "attempts": 3,
    "cache_control": "no-store",
    "changed": false,
    "connection": "close",
    "content_length": "1431",
    "content_type": "text/html; charset=utf-8",
    "cookies": {},
    "cookies_string": "",
    "date": "Thu, 07 Aug 2025 03:41:56 GMT",
    "elapsed": 0,
    "invocation": {
        "module_args": {
            "attributes": null,
            "body": null,
            "body_format": "raw",
            "ca_path": null,
            "ciphers": null,
            "client_cert": null,
            "client_key": null,
            "creates": null,
            "decompress": true,
            "dest": null,
            "follow_redirects": "safe",
            "force": false,
            "force_basic_auth": false,
            "group": null,
            "headers": {},
            "http_agent": "ansible-httpget",
            "method": "GET",
            "mode": null,
            "owner": null,
            "remote_src": false,
            "removes": null,
            "return_content": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "status_code": [
                200
            ],
            "timeout": 30,
            "unix_socket": null,
            "unredirected_headers": [],
            "unsafe_writes": false,
            "url": "http://172.17.17.163/health/",
            "url_password": null,
            "url_username": null,
            "use_gssapi": false,
            "use_netrc": true,
            "use_proxy": true,
            "validate_certs": true
        }
    },
    "msg": "OK (1431 bytes)",
    "redirected": false,
    "status": 200,
    "url": "http://172.17.17.163/health/",
    "vary": "Origin, Origin",
    "x_request_id": "c0d52eeeba2142c9a2c2109b6bbc918b"
}

PLAY RECAP *********************************************************************
localhost                  : ok=27   changed=8    unreachable=0    failed=0    skipped=0    rescued=0    ignored=1   

[2025-08-07 09:41:56] Ansible playbook completed successfully
[2025-08-07 09:41:56] Deactivating virtual environment...
[2025-08-07 09:41:56] Script completed with exit code 0
[2025-08-07 09:41:56] Log file saved to: /home/you/Desktop/ansible_db_migration_scripts/logs/ansible_migration_20250807_093901.log
